plot(mdsODXsmp$points[,1],mdsODXsmp$points[,2])
plot(mdsODXsmp$points[,1],mdsODXsmp$points[,2],col=ODXsmpl_cp)
plot(mdsODXsmp$points[,3],mdsODXsmp$points[,4],col=ODXsmpl_cp)
plot(mdsODXsmp$points[,1],mdsODXsmp$points[,4],col=ODXsmpl_cp)
rndpp[1:4000]
rndpep[1:4000]
which(ODXsample=="SKINNPL")
ODXs_2240[1:4000,1]
hist(BLOSUM62)
hist(-BLOSUM62)
hist(exp(-BLOSUM62))
hist(exp(BLOSUM62))
hist(log(5-BLOSUM62))
hist(log(10-BLOSUM62))
hist(log(11-BLOSUM62))
hist(log(10.5-BLOSUM62))
hist(log(10.8-BLOSUM62))
BLOSUM62
BLOSUM62
x=BLOSUM62[1:20,1:20]
z
x
image(-x)
min(-x)
x-min(x)
2^(-x+min(x))
source('C:/Users/Anastas/Google Drive/pepdist.R')
tm=proc.time()
smpldist=pepdist(ODXsample])
print(proc.time()-tm)
tm=proc.time()
smpldist=pepdist(ODXsample)
print(proc.time()-tm)
mdsODXsmp=cmdscale(smpldist,eig=TRUE, k=7)
plot(mdsODXsmp$points[,1],mdsODXsmp$points[,2])
rm(ODX0,ODX1,ODX2,ODX3,ODX0nm,ODX3nm,ODXc1,ODXc2,seq_ex,seqx1,seqx1pwmx,seqx1ranges,pwm9_4,pwm9_4l,pwma9_6,pwma9_6l,pwmL9_4
)
rm(pwmL9_4l,d3apwm,d3pwix,d3pwmord, distx, dodx2240,distx)
rm(d3ordapwm, d3oap_0, d3oap_cl0, d3oap_cl0_cl, d3oap_cl0_ixs, d3oap_cl0_file, d3oap_cl0_ixs,hODX0,hODX3, hODX3lin, hODX3nmlin, hODXlin,hODXnm0, hODXnmlin)
ODxs_2240_scores
rm(ODxs_2240_scores,odx2240Lpwmx,odx2240pwmx)
rm(tsned3ord,tsneqx1, tsne3Okm30, tsneix, tsneixcl)
rm(x1,x2,x3,x4,xN,xx,xy,y1,z,zz1,zz2)
rm(xy)
rm(xY)
ODXs_790=read.table("ODXsel_790.core", stringsAsFactors = FALSE)[,-2]
odx790pwmx=cnstrPWMtab0("ODXsel_790.core")
odx790Lpwmx=apply(odx790pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
ODXsample=c(ODXs_790[1:2000,1],rndpep[1:2000])
unique(ODXs_790[1:4000,2])
unique(ODXs_790[1:2000,2])
ODXsample=c(ODXs_790[1:4000,1],rndpep[1:4000])
ODXsmpl_cp=c(ODXs_790[1:4000,2]+2,rep(1,4000))
tm=proc.time()
smpldist=pepdist(ODXsample)
tm=proc.time()
smpldist=pepdist(ODXsample)
print(proc.time()-tm)
hist(smpldist,breaks = 3000)
source('C:/Users/Anastas/Google Drive/pepdist.R')
source('C:/Users/Anastas/Google Drive/pepdist.R')
hist(sqrt(smpldist),breaks = 3000)
hist((smpldist)^.25,breaks = 3000)
hist(log10(smpldist),breaks = 3000)
hist(log10(sqrt(smpldist)),breaks = 3000)
rndpepchr[1]
BLOSUM62[rndpepchr[[1]],rndpepchr[[2]]]
i=1:7
BLOSUM62[rndpepchr[[1]][i],rndpepchr[[2]][i]]
i=1:7
sapply(i,function(j)BLOSUM62[rndpepchr[[1]][j],rndpepchr[[2]][j]])
ODXsample=c(ODXs_790[1:1000,1],rndpep[1:4000])
ODXsample=c(ODXs_790[1:1000,1],rndpep[1:1000])
tm=proc.time()
smpldist=pepdist(ODXsample)
tm=proc.time()
mdsODXsmp=cmdscale(smpldist,eig=TRUE, k=7)
kpcamdsODX=kpca(mdsODXsmp$points)
library("kernlab", lib.loc="~/R/win-library/3.3")
library("kernlab", lib.loc="~/R/win-library/3.3")
image(as.matrix(smpldist))
tm=proc.time()
smpldist=pepdist(ODXsample[1:500])
print(proc.time()-tm)
tm=proc.time()
smpldist=pepdist(ODXsample[1:1000])
print(proc.time()-tm)
tm=proc.time()
smpldist=pepdist(ODXsample[1:8000])
print(proc.time()-tm)
rm(smpldist)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibb_out.R')
library("stringi", lib.loc="~/R/win-library/3.3")
stri_extract_first("# -g       790                  Number of initial clusters", regex = "\\d+")
readGibbs_out("ODXsel_790.out")
close()
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
paste(c("Cluster", 33), collpase=" ")
paste(c("Cluster", 33), collpase=" ")
readGibbs_out("ODXsel_790.out")
x=readGibbs_out("ODXsel_790.out")
x=readGibbs_out("ODXsel_790.out")
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x=readGibbs_out("ODXsel_790.out")
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x=readGibbs_out("ODXsel_790.out")
x
x=readGibbs_out("ODXsel_790.out")
x
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x=readGibbs_out("ODXsel_790.out")
x
View(readGibbs_out)
View(readGibb_out)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x=readGibbs_out("ODXsel_790.out")
hdr
unlist(hdr)
x=readGibbs_out("ODXsel_790.out")
x
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x
x=readGibbs_out("ODXsel_790.out")
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x=readGibbs_out("ODXsel_790.out")
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
x=readGibbs_out("ODXsel_790.out")
n
n
x
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/readGibbs_out.R')
ODxs790out=readGibbs_out("ODXsel_790.out")
ODxs790out[1]
plot(ODxs790out[[1]]$Self,ODxs790out[[1]]$Corrected)
plot(ODxs790out[[1]]$Self,ODxs790out[[1]]$BGscore)
lm(ODxs790out[[1]]$Self,ODxs790out[[1]]$Corrected)
lm(ODxs790out[[1]]$Corrected~ODxs790out[[1]]$Self)
x=ODxs790out[[1]][ODxs790out[[1]]$Corrected>ODxs790out[[1]]$BGscore,]
x
nrow(x)
rm(readGibb_out())
rm(readGibb_out
rm(readGibb_out)
rm(readGibb_out)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
cnstrPWM(ODxs790out[[1]]$Alignment)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
cnstrPWM(ODxs790out[[1]]$Alignment)
psLogo(cnstrPWM(ODxs790out[[1]]$Alignment))
x
cnstrPWM(x)
cnstrPWM(x$Alignment)
psLogo(cnstrPWM(x$Alignment))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/psLogo.R')
psLogo(cnstrPWM(x$Alignment))
ODXs790clean=lapply(ODxs790out,function(x){x[x$Corrected>x$BGscore & x$Corrected>12,]})
lengths(ODXs790clean)
lengths(nrows(ODXs790clean))
sapply(ODXs790clean, function(x){dim(x)})
sapply(ODXs790clean, function(x){dim(x)[1]})
sum(sapply(ODXs790clean, function(x){dim(x)[1]}))
sapply(ODXs790clean, function(x){psLogo(cnstrPWM(x$Alignment))})
ODXs790trash=lapply(ODxs790out,function(x){x[x$Corrected<=x$BGscore | x$Corrected<=12,]})
sapply(ODXs790clean, function(x){dim(x)[1]})
sapply(ODXs790trash, function(x){dim(x)[1]})
sum(sapply(ODXs790trash, function(x){dim(x)[1]}))
range(sapply(ODXs790trash, function(x){dim(x)[1]}))
range(sapply(ODXs790clean, function(x){dim(x)[1]}))
peptrash=sapply(ODXs790trash,function(x){x$Alignment})
peptrash=unlist(peptrash)
length(peptrash)
length(unique(peptrash))
rm(peptrash)
peplotrash=sapplY(ODXs790trash, function(x){x[x$Corrected<10&x$BGscore<10,]})
peplotrash=sapply(ODXs790trash, function(x){x[x$Corrected<10&x$BGscore<10,]})
peplotrash
sapply(peplotrash,functionx(x){dim(x)[1]})
sapply(peplotrash,function(x){dim(x)[1]})
peplotrash=sapply(ODXs790trash, function(x){x[x$Corrected<10,]})
sapply(peplotrash,function(x){dim(x)[1]})
peplotrash=lapply(ODXs790trash, function(x){x[x$Corrected<10,]})
sapply(peplotrash,function(x){dim(x)[1]})
peplotrash
peplotrash=lapply(ODXs790trash, function(x){x[x$Corrected<10 & x$BGscore<10,]})
sapply(peplotrash,function(x){dim(x)[1]})
sum(sapply(peplotrash,function(x){dim(x)[1]}))
peplotrash
peplotrash[[1:790]]$alignment
peplotrash[1:790]$alignment
peplotrash[1:790]$alignment
peplotrash[1:790]$alignment
peplotrash[[1]]$Alignment
ODxs790out
ODxs790out[[10]]
ODXs790clean[[10]]
psLogo(cnstrPWM(ODxs790out[[10]]))
psLogo(cnstrPWM(ODxs790out[[10]]$Alignment))
psLogo(cnstrPWM(ODXs790clean[[10]]$Alignment))
psLogo(cnstrPWM(ODXs790trash[[10]]$Alignment))
psLogo(cnstrPWM(ODxs790out[[7]]$Alignment))
psLogo(cnstrPWM(ODXs790clean[[7]]$Alignment))
psLogo(cnstrPWM(ODXs790trash[[7]]$Alignment))
ODXs790trash=lapply(ODxs790out,function(x){x[x$Corrected<=x$BGscore,]})
ODXs790clean=lapply(ODxs790out,function(x){x[x$Corrected>x$BGscore,]})
psLogo(cnstrPWM(ODxs790out[[10]]$Alignment))
psLogo(cnstrPWM(ODXs790clean[[10]]$Alignment))
psLogo(cnstrPWM(ODXs790trash[[10]]$Alignment))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/findallscore.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
ODXs790sc=findallscore(odx790Lpwmx, ODXs_790)
length(ODXs790sc)
head(ODXs790sc)
odx790Lpwmx[[1]]
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
ODXs790sc=findallscore(odx790Lpwmx, ODXs_790)
profcheck(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
odx790Lpwmx[[1]]
odx790Lpwmx[1]
odx790Lpwmx[[1]][[1]]
profchk(odx790Lpwmx[[1]][[1]],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
odx790Lpwmx=apply(odx790pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
for (i in 1:length(odx790Lpwmx)){
colnames(odx790Lpwmx[[i]][[1]])=aa
}
odx790Lpwmx[[1]]
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[1],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[[1]][1],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[[1]][[1],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[[1]][[1]],strsplit(ODXs_790[1:200,1],split=""),7)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
profchk(odx790Lpwmx[[1]][[1]],strsplit(ODXs_790[1:200,1],split=""),7)
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
pwm
pwm[[1]]
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
nrow(pwm)
nrow(pwm[[1]])
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
p
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profchk.R')
profchk(odx790Lpwmx[[1]],strsplit(ODXs_790[1:200,1],split=""),7)
ODXs790sc=findallscore(odx790Lpwmx, ODXs_790)
ODXs790sc[1]
ODXs790sc
length()ODXs790sc
length(ODXs790sc)
plot(ODXs790sc[1:290], ODxs790out[[1]]$Self[1:290])
plot(ODXs790sc[1:290], ODxs790out[[1]]$Self[1:290])
plot(ODXs790sc[1:290], ODxs790out[[1]]$Corrected[1:290])
rm(ODXs_2240)
View(cfvn)
write.table(ODXsample,"ODXsample1.txt")
hist(ODXs790sc, breaks = 10000)
hist(ODXs790sc, breaks = 3000)
quantile(ODXs790sc,c(.95, .99, .999))
length(ODXs790sc)
length(ODXs790sc[ODXs790sc>16.87])
head(ODXs790sc)
ODXs_790[ODXs_790[which(ODXs790sc>16.87),]
]
which(ODXs790sc>16.87)
ODXs_790[ODXs_790[unlist(which(ODXs790sc>16.87)),]]
ODXs_790[unlist(which(ODXs790sc>16.87)),]
ODXs790sc01=ODXs_790[unlist(which(ODXs790sc>16.87)),]
unique(ODXs790sc01[,2])
clsc01=unique(ODXs790sc01,2])
clsc01=unique(ODXs790sc01[,2])
clsc01n=sapply(clsc01,function(x){length(ODXs790sc01[ODXs790sc01[,2]==x,2])})
clsc01n
length(clsc01n[clsc01n>3])
hist(clsc01n)
ODXs790sc01
length(clsc01n[clsc01n>30])
length(clsc01n[clsc01n>20])
length(clsc01n[clsc01n>10])
clsc01n[clsc01n>30]
clsc01n[clsc01n>10]
clsc01[clsc01n>10]
clsc01n10=clsc01[clsc01n>10]
psLogo(cnstrPWM(ODXs790clean[[clsc01n10]]$Alignment))
clsc01n10
lapply(clsc01n10,function(i){psLogo(cnstrPWM(ODXs790clean[[i]]$Alignment))})
Reduce("+",sapply(clsc01n10,function(i){odx790Lpwmx[[i]]}))
psLogo(Reduce("+",sapply(clsc01n10,function(i){odx790Lpwmx[[i]]})))
psLogo(Reduce("+",sapply(clsc01n10,function(i){odx790Lpwmx[[i]]})))
gnrlpwm=Reduce("+",sapply(clsc01n10,function(i){odx790Lpwmx[[i]]}))
psLogo(t(gnrlpwm))
gnrlpwm=Reduce("+",sapply(clsc01n10,function(i){odx790Lpwmx[[i]]}))/length(clsc01n10)
psLogo(t(gnrlpwm))
ODxs790_15.out=readGibbs_out("ODXs_790_15.txt"")
ODxs790_15.out=readGibbs_out("ODXs_790_15.txt")
ODxs790_15.out=readGibbs_out("ODXs_790_15.out")
ODxs790_20.out=readGibbs_out("ODXs_790_20.out")
ODxs790_30.out=readGibbs_out("ODXs_790_30.out")
ODXs_790_15=read.table("ODXs_790_15.core", stringsAsFactors = FALSE)[,-2]
ODXs_790_20=read.table("ODXs_790_20.core", stringsAsFactors = FALSE)[,-2]
ODXs_790_30=read.table("ODXs_790_30.core", stringsAsFactors = FALSE)[,-2]
x1=ODXsel[,1]
x2=sapply(x1,function(i){ODXs_790[ODXs_790[,1]==i,2]})
x3=sapply(x1,function(i){ODXs_790_15[ODXs_790_15[,1]==i,2]})
x4=sapply(x1,function(i){ODXs_790_20[ODXs_790_20[,1]==i,2]})
x5=sapply(x1,function(i){ODXs_790_30[ODXs_790_30[,1]==i,2]})
crossclus=data.frame(cbind(x2,x3,x4,x5), row.names = x1, stringsAsFactors = FALSE)
crossclord=crossclus[order(crossclus[,1],crossclus[,2],crossclus[,3],crossclus[,4]),]
crclorFl=matrix(0, nrow(crossclus), ncol = 1)
for (i in 2:nrow(crclorFl)){
if(all(crossclord[i,]==crossclord[i-1,])==TRUE) {crclorFl[(i-1):i]=1}
}
length(crclorFl[crclorFl==1])
clsc01
clsc01n
crossclus
crclsel=crossclu[which(crclorFl==1),]
crclsel=crossclus[which(crclorFl==1),]
crclsel
crclsel=crossclord[which(crclorFl==1),]
crclsel
all(crossclord[85,]==crossclord[84,])==TRUE)
all(crossclord[85,]==crossclord[84,])
all(crossclord[87,]==crossclord[86,])
sum(crossclord[87,]==crossclord[86,])
crossclord[80:87,]
sum(crossclord[86,]==crossclord[85,])
crclorFl=matrix(0, nrow(crossclus), ncol = 1)
for (i in 2:nrow(crclorFl)){
if(sum(crossclord[i,]==crossclord[i-1,])>2) {crclorFl[(i-1):i]=1}
}
length(crclorFl[crclorFl==1])
crclsel=crossclord[which(crclorFl==1),]
crclsel
crossclord=crossclus[order(crossclus[,4],crossclus[,1],crossclus[,3],crossclus[,2]),]
crclorFl=matrix(0, nrow(crossclus), ncol = 1)
for (i in 2:nrow(crclorFl)){
if(all(crossclord[i,]==crossclord[i-1,])==TRUE) {crclorFl[(i-1):i]=1}
}
length(crclorFl[crclorFl==1])
crclorFl34=matrix(0, nrow(crossclus), ncol = 1)
for (i in 2:nrow(crclorFl34)){
if(sum(crossclord[i,]==crossclord[i-1,])>2) {crclorFl34[(i-1):i]=1}
}
length(crclorFl34[crclorFl34==1])
length(crclorFl34[crclorFl34==1 & crclorFl==1])
crossclord14=crossclus[order(crossclus[,1],crossclus[,2],crossclus[,3],crossclus[,4]),]
crclorFl14=matrix(0, nrow(crossclus), ncol = 1)
for (i in 2:nrow(crclorFl34)){
if(sum(crossclord[i,]==crossclord[i-1,])>2) {crclorFl14[(i-1):i]=1}
}
length(crclorFl34[crclorFl34==1 & crclorFl14==1])
rm(crclorFl14, crclorFl14)
rm(crclorFl14, crossclord14)
crclsel41=crossclord[which(crclorFl34==1),]
crclsel141=rbind(crclsel, crclsel41)
crclsel141=unique(crclsel141)
nrow(crclsel141)
kmcrclsel141=kmeans(crclsel141, 790, nstart = 3)
kmcrclsel141=kmeans(crclsel141, 790, iter.max=30, nstart = 3)
kmcrclsel141
kmcrclsel141$centers
install.packages("klaR")
for (i in 1:4){
crclsel141[,i]=as.factor(crclsel141[,i])
}
library("klaR", lib.loc="~/R/win-library/3.3")
kmcrclsel141=kmodes(crclsel141, 790, iter.max = 30)
pamcrclsel141=pam(daisy(crclsel141, metric="gower"), 790, cluster.only=TRUE)
library("cluster", lib.loc="C:/Program Files/R/R-3.3.1/library")
pamcrclsel141=pam(daisy(crclsel141, metric="gower"), 790, cluster.only=TRUE)
pamcrclsel141=pam(daisy(crclsel141, metric="gower"), 400, cluster.only=TRUE)
ODXs=list(ODXs79030=ODXs_790_30,ODXs79001=ODXs_790,ODXs79015=ODXs_790_15,ODXs79020=ODXs_790_20)
lapply(1:10,function(x){p1=x^2; p2=x^3; p1+p2})
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
ODXs_x=clustensus(ODXs)
rm(x1,x2)
ODXs_x=clustensus(ODXs)
ODXs_x=clustensus(ODXs)
ODXs_x
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
ODXs_x=clustensus(ODXs)
ODXs_x
lengths(ODXs_x)
max(lengths(ODXs_x))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
ODXs_x1=clustensus(ODXs)
ODXs_x1
max(lengths(ODXs_x1))
max(lengths(ODXs_x))
min(lengths(ODXs_x))
ODXs_x=ODXs_x1
rm(ODXs_x1)
sum(lengths(ODXs_x))
View(readMatochko)
write.fas
library("seqinr", lib.loc="~/R/win-library/3.3")
write.fasta(ODXsel,ODXsel,"ODXsel.fasta")
write.fasta(as.list(ODXsel),ODXsel,"ODXsel.fasta")
write.fasta(as.list(ODXsel),ODXsel,"ODXsel.fasta", as.string = TRUE)
write.fasta(ODXsel,ODXsel,"ODXsel.fasta", as.string = TRUE)
write.fasta(ODXsel[,1],ODXsel[,1],"ODXsel.fasta", as.string = TRUE)
ODXsel[,1]
is.list(ODXsel[,1])
write.fasta(as.list(ODXsel[,1]),ODXsel[,1],"ODXsel.fasta", as.string = TRUE)
x=ODXsel[,1]
sample(aa,10)
x1=sample(aa,length(x))
x1=sample(aa,length(x), replace = TRUE)
x2=sapply(1:length(x),function(i){paste(c(x[i],x1[i]), collapse = "")})
x2
write.fasta(as.list(x2),ODXsel[,1],"ODXsel.fasta", as.string = TRUE)
x2=sapply(1:length(x),function(i){paste(c(x[i],"x1[i]"GGGS""), collapse = "")})
x2=sapply(1:length(x),function(i){paste(c(x[i],"GGGS"), collapse = "")})
x2
x2=sapply(1:length(x),function(i){paste(c(x[i],"G"), collapse = "")})
write.fasta(as.list(x2),ODXsel[,1],"ODXsel.fasta", as.string = TRUE)
ODXs_790_30
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/clustensus.R')
odx79015pwmx=cnstrPWMtab0("ODXsel_790_15.core")
odx79015pwmx=cnstrPWMtab0("ODXs_790_15.core")
odx79020pwmx=cnstrPWMtab0("ODXs_790_20.core")
odx79030pwmx=cnstrPWMtab0("ODXs_790_30.core")
odx79015Lpwmx=apply(odx79015pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
odx79020Lpwmx=apply(odx79020pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
odx79030Lpwmx=apply(odx79030pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
ODXs_x[1:10]
View(pscnt)
View(pscnt)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
ODXsxpwm=lapply(ODXs_x,function(x){cnstrPWM(x)})
ODXsxpwm[1:10]
psLogo(ODXsxpwm[1:10])
psLogo(ODXsxpwm[[1:10]])
sapply(1:10,function(i){psLogo(ODXsxpwm[[i]])})
library("Biostrings", lib.loc="~/R/win-library/3.3")
ODXspssm=lapply(ODXs_x,function(x){consensusMatrix(x)})
head(ODXspssm)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
ODXsmx=lapply(ODXs_x,function(x){consensusMatrix(x)})
ODXsmx[[1]]
ODXsmx[1
]
ODXsmx[1]
ODXsmx=lapply(ODXs_x,function(x){consensusMatrix(x)[2]})
ODXsmx[1]
ODXsmx=lapply(ODXs_x,function(x){consensusMatrix(x)[2]})
ODXsmx=lapply(ODXs_x,function(x){cnstrPWM(x)})
ODXsmx[1]
ODXsmx=lapply(ODXs_x,function(x){cnstrPWM(x)})
ODXsmx[1]
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWM.R')
ODXsmx=lapply(ODXs_x,function(x){cnstrPWM(x)})
ODXsmx[1]
rm(ODXspssm,ODXsxpwm)
aas=aaPh7[,2]
rep(aas, 7)
matrix(rep(aas, 7), nrow = 20)
ODXsmx[[1]][[1]]*matrix(rep(aas, 7), nrow = 20)
aaPh7[,2]
0.063*0.95
0.0091*0.95
0.047*0.05
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profpv.R')
ODXsxp=lappply(ODXsmx,function(x){profp(x[[1]][[1]])})
ODXsxp=lapply(ODXsmx,function(x){profp(x[[1]][[1]])})
ODXsxp=lapply(ODXsmx,function(x){profpv(x[[1]][[1]])})
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profpv.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/profpv.R')
profpv(ODXsmx[[1]][[1]])
pssm
ODXs_x[[1]]
is.list(ODXs_x[[1]])
sapply(ODXs_x[[1]], function(x{s=strsplit(x,split"")
prod(aaPh7[s,2])}))
s=strsplit(oDXs_x[[1]][1])
s=strsplit(ODXs_x[[1]][1])
s=strsplit(ODXs_x[[1]][1], split="")
s
s=strsplit(ODXs_x[[1]][1], split="")[[1]]
s
aaPh7[s,2]
prod(aaPh7[s,2])
ODXsxp=lapply(ODXsmx,function(x){profpv(x[[1]][[1]])})
ODXsxp=lapply(ODXsmx,function(x){profpv(x[[1]][[1]])})
Q
ODXsxp=lapply(ODXsmx,function(x){profpv(x[[1]])})
ODXsxp
ODXsxp=unlist(ODXsxp)
ODXsxp
ODXsxp=lapply(ODXsmx,function(x){profpv(x[[1]][[1]])})
prod(aaPh7[s,2])
x=sum(sapply(ODXs_x[[1]], function(i){s=strsplit(i,split="")
prod(aaPh7[s,2])}))
x=sum(sapply(ODXs_x[[1]], function(i){s=strsplit(i,split="")
prod(aaPh7[unlist(s),2])}))
x
x*224000
savehistory("~/BG/NorwayLichtensteinIsland/Execution/exp/DB/190816.Rhistory")
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/LOpwm.R')
View(ODxs)
View(ODXs)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/findpvscore.R')
ODXs79030pepch
ODXs79030scchosen
peppostive=unlist(pep79030_shi[lengths(pep79030_shi)>3])
peppostive
peppostive=unlist(pep79030_99[lengths(pep79030_99)>3])
peppostive
x=unlist(pep79030_shi[lengths(pep79030_shi)==3])
x
peppostive=unlist(pep79030_shi[lengths(pep79030_shi)>3])
x=unlist(pep79030_shi[lengths(pep79030_shi)==3])
peppostive=c(peppostive,x[1:270])
peppostive
tu_out=readGibbs_out("tucalls.out")
tu_c=read.table("tucalls.core", stringsAsFactors = FALSE)[,-2]
pepX=BString(pep)
pepsaaX=AAStringSet(paste(peps, collapse=""))
aaTu=alphabetFrequency(pepsaaX)
aaTu=aaTu/nchar(paste(peps, collapse=""))
aaTu=unlist(aaTu[1:20])
tu_pwmx=cnstrPWMtab0("tucalls.core", aas=aaTu)
tu_Lpwmx=apply(tu_pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
for (i in 1:11) {colnames(tu_Lpwmx[[i]][[1]])=aa}
sapply(1:11,function(i){psLogo(t(tu_Lpwmx[[i]][[1]]))})
tupwmsc=lapply(1:11,function(i){list(tu_Lpwmx[[i]][[1]],tu_sc[i])})
tu_sc=sapply(1:11, function(i){y=strsplit(tu_c[tu_c[,2]==(i-1),1], split=""); median(sapply(y,function(x){profchk(tu_Lpwmx[[i]][[1]],x,7)}))})
tu_sc
tupwmsc=lapply(1:11,function(i){list(tu_Lpwmx[[i]][[1]],tu_sc[i])})
rndp_tu_pwmpv=findpvscore(tupwmsc, rndpepchr)
rnd_tu_pwmEv=sapply(1:11,function(i){1-pbinom(length(tu_c[tu_c[,2]==i,1])/2,4524*9,rndp_tu_pwmpv[[i]])})
rnd_tu_pwmEv
ODXs79030scall
chosen_tu=rndp_tu_wmEv<0.05
tixchosen=which(chosen_tu)
chosen_tu=rndp_tu_pwmEv<0.05
tixchosen=which(chosen_tu)
chosen_tu=rnd_tu_pwmEv<0.05
tixchosen=which(chosen_tu)
tixchosen
tu_pepch=lapply(tixchosen,function(i){xxpep[[i]]})
tu_pep=lapply(1:11, function(i){tu_c[V[,2]==(i-1),1]})
tu_pep=lapply(1:11, function(i){tu_c[tu_c[,2]==(i-1),1]})
tu_pepch=lapply(tixchosen,function(i){tu_pep[[i]]})
tu_scall=sapply(1:11, function(i){y=strsplit(tu_c[tu_c[,2]==(i-1),1], split="");sapply(y,function(x){profchk(tu_Lpwmx[[i]][[1]],x,7)})})
tuscchosen=tu_scall[chosen_tu]
names(tuscchosen)=tixchosen
mODXs7930scall=lapply(ODXs79030scall,median)
mODXs7930scall
ODXs79030scall[order(mODXs7930scall, decreasing = TRUE)]
ODXs79030scall[order(unlist(mODXs7930scall), decreasing = TRUE)]
head(ODXs79030scall[order(unlist(mODXs7930scall), decreasing = TRUE)])
which(mODXs7930scall==max(mODXs7930scall))
mODXs7930scall=unlis(mODXs7930scall)
mODXs7930scall=unlist(mODXs7930scall)
which(mODXs7930scall==max(mODXs7930scall))
ixchosen
which(rndpODXs79030pwmEv==min(rndpODXs79030pwmEv))
min(rndpODXs79030pwmEv)
which(rndpODXs79030pwmpv==min(unlist(rndpODXs79030pwmpv)))
pep277_317=c(ODXs79030pep[[277]],ODXs79030pep[[317]])
length(pep277_317)
lengths(pep[which(rndpODXs79030pwmEv==min(rndpODXs79030pwmEv))])
lengths(pep[[which(rndpODXs79030pwmEv==min(rndpODXs79030pwmEv))]])
lengths( ODXs79030pep[which(rndpODXs79030pwmEv==min(rndpODXs79030pwmEv))])
rndpepchr=rndpeppre(2300000)
length(rndpepchr)
rndpepchr
tm=proc.time()
rndpODXs79030pwmpv=findpvscore(ODXs79030pwmsc, rndpepchr)
print(proc.time()-tm)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/findpvscore.R')
rndpODXs79030pwmEv=sapply(1:790,function(i){1-pbinom(length(ODXs_790_30[ODXs_790_30[,2]==i,1])/2,224000,rndpODXs79030pwmpv[[i]])})
chosen79030=rndpODXs79030pwmEv<0.01
ixchosen=which(chosen79030)
ixsuperhi=which(rndpODXs79030pwmEv==0)
ODXs79030pepch=lapply(ixchosen,function(i){ODXs79030pep[[i]]})
ODXs79030scall=sapply(1:790, function(i){y=strsplit(ODXs_790_30[ODXs_790_30[,2]==(i-1),1], split="");sapply(y,function(x){profchk(odx79030Lpwmx[[i]][[1]],x,7)})})
ODXs79030scchosen=ODXs79030scall[chosen79030]
names(ODXs79030scchosen)=ixchosen
pep79030_99=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=0.9873)]})
pep79030_99
length(unlist(pep79030_01))
length(unlist(pep79030_99))
peppostive=unlist(pep79030_99)
pepnegtve=unlist(pep79030_01)
psLogo(odx79030Lpwmx[207])
ODXs79030scchosen
which(rndpODXs79030pwmEv==min(rndpODXs79030pwmEv))
which(rndpODXs79030pwmpv==min(unlist(rndpODXs79030pwmpv)))
lengths( ODXs79030pep[which(rndpODXs79030pwmEv==min(rndpODXs79030pwmEv))])
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R', encoding = 'UTF-8')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R')
aa
consensusMatrix(ODXs_790_30[ODXs_790_30[,2]==1,1])
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R')
odx79030pwmx=cnstrPWMtab0("ODXs_790_30.core")
odx79030Lpwmx=apply(odx79030pwmx,1,function(x){list(matrix(x, nrow=7, byrow=TRUE))})
for (i in 1:790) {colnames(odx79030Lpwmx[[i]][[1]])=aa}
ODXs79030_sc=sapply(1:790, function(i){y=strsplit(ODXs_790_30[ODXs_790_30[,2]==(i-1),1], split=""); median(sapply(y,function(x){profchk(odx79030Lpwmx[[i]][[1]],x,7)}))})
ODXs79030pwmsc=lapply(1:790,function(i){list(odx79030Lpwmx[[i]][[1]],ODXs79030_sc[i])})
ODXs79030pep=lapply(1:790, function(i){ODXs_790_30[ODXs_790_30[,2]==(i-1),1]})
psLogo(t(odx79015Lpwmx[[1]][[1]]))
odx79015Lpwmx[[1]][[1]]
for (i in 1:790) {colnames(odx79030Lpwmx[[i]][[1]])=aa}
odx79015Lpwmx[[1]][[1]]
odx79015Lpwmx[[1]]
aa
odx79030Lpwmx[[1]]
psLogo(t(odx79030Lpwmx[[1]][[1]]))
x=sample(rndpepchr, 3*nrow(ODXsel))
length(x)
hist(rndpODXs79030pwmpv, breaks = 500)
rndpODXs79030pwmpv
hist(unlist(rndpODXs79030pwmpv), breaks = 500)
hist(unlist(rndpODXs79030pwmpv), breaks = 50)
cmpxprf=odx79030Lpwmx[unlist(rndpODXs79030pwmpv)<3e-4]
length(cmpxprf)
cmpxprf=odx79030Lpwmx[unlist(rndpODXs79030pwmpv)<1e-4]
length(cmpxprf)
sapply(1:7, function(x){psLogo(t(cmpxprf[[x]][[1]]))})
rareprfl=cmpxprf
rm(cmpxprf)
frewprfl=odx79030Lpwmx[unlist(rndpODXs79030pwmpv)>8e-4]
length(frewprfl)
length(peppostive)
pep79030_99
which(chosen79030)
rank79030pvals=names(ODXs79030scchosen)[order(rndpODXs79030pwmEv[chosen79030])]
rank
rank79030pvals
rank79030pvals=names(ODXs79030scchosen)[order(rndpODXs79030pwmEv[chosen79030], decreasing = TRUE)]
head(rank79030pvals)
psLogo(t(odx79030Lpwmx[[364]][[1]]))
head(rank79030pvals)
psLogo(t(odx79030Lpwmx[[763]][[1]]))
head(odx79030pwmx)
head(odx79030Lpwmx)
head(rank79030pvals)
ODXs79030pep[rank79030pvals[1:6]]
ODXs79030pep[as.double(rank79030pvals[1:6])]
lengths(ODXs79030pep[as.double(rank79030pvals[1:6])])
rank79030pvals=names(ODXs79030scchosen)[order(rndpODXs79030pwmEv[chosen79030])]
lengths(ODXs79030pep[as.double(rank79030pvals[1:6])])
ODXs79030pep[as.double(rank79030pvals[1:6])]
lengths(ODXs79030pep[as.double(rank79030pvals[1:6])])
head(rank79030pvals)
223+272+179+239+292
(223+272+179+239+292)/2
rm(pep227_317,pep277_317)
lengths(ODXs79030pep[as.double(rank79030pvals[1:6])])
head(rank79030pvals)
pep_top_5=lapply(rank79030pvals[1:5], function(x){ODXs79030pep[[as.double(x)]]})
pep_top_5=lapply(rank79030pvals[1:5], function(x){ODXs79030pep[[as.double(x)]]})
pep_top_5
ODXs79030pep
head(ODXs79030scall)
head(ODXs79030_sc)
pep_top_5=lapply(rank79030pvals[1:5], function(x){i=as.double(x); ODXs79030pep[[i]][ODXs79030scall[[i]]>ODXs79030_sc[[i]]]})
pep_top_5=lapply(rank79030pvals[1:5], function(x){i=as.double(x); ODXs79030pep[[i]][ODXs79030scall[[i]]>ODXs79030_sc[[i]]]})
pep_top_5
length(unlit(pep_top_5))
length(unlist(pep_top_5))
pep_top_5=unlist(pep_top_5)
aaTu
alphabetFrequency(pepsaaX)
alphabetFrequency(pepsaaX)/nchar(paste(peps, collapse=""))
rndp_tu_pwmpv=findpvscore(tupwmsc, sample(rndpepchr, 9*4524*10))
peps
rndpepTuchr=rndpeppre(400000, aa=aaTu)
rndp_tu_pwmpv=findpvscore(tupwmsc, sample(rndpepTuchr, 9*4524*10))
rnd_tu_pwmEv=sapply(1:11,function(i){1-pbinom(length(tu_c[tu_c[,2]==i,1])/2,4524*9,rndp_tu_pwmpv[[i]])})
rndpepTuchr=rndpeppre(400000, aa=aaTu)
rndp_tu_pwmpv=findpvscore(tupwmsc, sample(rndpepTuchr, 9*4524*10))
rnd_tu_pwmEv=sapply(1:11,function(i){1-pbinom(length(tu_c[tu_c[,2]==i,1])/2,4524*9,rndp_tu_pwmpv[[i]])})
length(rndpepTuchr)
rndpepTuchr=rndpeppre(400000, aa=aaTu)
rndp_tu_pwmpv=findpvscore(tupwmsc, rndpepTuchr)
rnd_tu_pwmEv=sapply(1:11,function(i){1-pbinom(length(tu_c[tu_c[,2]==i,1])/2,4524*9,rndp_tu_pwmpv[[i]])})
hist(rnd_tu_pwmEv)
rnd_tu_pwmEv
chosen_tu=rnd_tu_pwmEv<0.05
chosen_tu=rnd_tu_pwmEv<0.05
chosen_tu
tixchosen=which(chosen_tu)
tixchosen=which(chosen_tu)
tixchosen
tu_pep=lapply(1:11, function(i){tu_c[tu_c[,2]==(i-1),1]})
tu_pepch=lapply(tixchosen,function(i){tu_pep[[i]]})
tu_scall=sapply(1:11, function(i){y=strsplit(tu_c[tu_c[,2]==(i-1),1], split="");sapply(y,function(x){profchk(tu_Lpwmx[[i]][[1]],x,7)})})
tuscchosen=tu_scall[chosen_tu]
names(tuscchosen)=tixchosen
tu_pepch
length(unlist(tu_pepch))
pep_tu_50=lapply(1:length(tixchosen), function(i){tu_pepch[[i]][tuscchosen[[i]]>quantile(tuscchosen[[i]], probs=0.05)]})
pep_tu_50
length(unlist(pep_tu_50))
length(peppostive)+length(pepnegtlo)+length(pepnegtve)+lemgth(pep_top_5)+length(pep_tu_50)
length(peppostive)+length(pepnegtlo)+length(pepnegtve)+length(pep_top_5)+length(pep_tu_50)
length(peppostive)+length(pepnegtlo)+length(pepnegtve)+length(pep_top_5)
pep_top_5
length(peppostive)+length(pepnegtlo)+length(pepnegtve)+length(pep_top_5)+length(unlist(pep_tu_50))
4524-2549
hist(rndp_tu_pwmpv)
hist(unlist(rndp_tu_pwmpv))
rndp_tu_pwmpv
hist(tu_scall)
sapply(1:10,function(i){hist(tu_scall[i])})
sapply(1:10,function(i){hist(tu_scall[[i]])})
tu_scall
sapply(1:10,function(i){hist(tu_scall[[i]])})
tu_sc
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/smpep.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/smpep.R')
turndprofsmpl=smpep(tupwmsc, rndpepTuchr)
pepturnd=unlist(sapply(1:10, function(i){sapply(1:lengths(turndprofsmpl)[i], function(j){paste(turndprofsmpl[[i]][[j]],sep="",collapse="")})}))
pepturnd
length(peppostive)
length(pepnegtve)
length(pepnegtlo)
length(pep_top_5)
length(pep_tu_50)
chosen79030=rndpODXs79030pwmEv<0.000001
ixchosen=which(chosen79030)
ixchosen
chosen79030=rndpODXs79030pwmEv<0.00000001
ixchosen=which(chosen79030)
chosen79030=rndpODXs79030pwmEv<0.00000001
ixchosen=which(chosen79030)
ixchosen
length(ixchosen)
length(pepnegtlo)
chosen79030=rndpODXs79030pwmEv<1e-12
ixchosen=which(chosen79030)
ixchosen
chosen79030=rndpODXs79030pwmEv<1e-4
ixchosen=which(chosen79030)
length(ixchosen)
ODXs79030pepch
length(unlist(ODXs79030pepch))
p=1e-6
pep79030_01=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]<quantile(ODXs79030scchosen[[i]], probs=p)]})
# ... and of the high scores
pep79030_99=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-p))]})
peppostive=unlist(pep79030_99)
pepnegtve=unlist(pep79030_01)
ODXs79030trash$Alignment[ODXs79030trash$Self<5]
ODXs79030trash=as.data.frame(t(sapply(ODxs790_30.out,function(x){x[x$Corrected==min(x$Corrected),]})))
peplotrash=ODXs79030trash$Alignment[ODXs79030trash$Self<5]
pepnegtlo=unlist(peplotrash)
length(intersect(peplo,pepnegtve))
pepnegtlo
length(c(peppostive. pepnegtlo, pep_top_5, pepnegtve)
length(c(peppostive, pepnegtlo, pep_top_5, pepnegtve)
pep_tu_50=lapply(1:length(tixchosen), function(i){tu_pepch[[i]][tuscchosen[[i]]>quantile(tuscchosen[[i]], probs=0.80)]})
unlist(pep_tu_50)
pep_tu_80=unlist(pep_tu_50)
length(c(peppostive, pepnegtlo, pep_top_5, pepnegtve, pep_tu_80))
pepturnd
length(c(peppostive, pepnegtlo, pep_top_5, pepnegtve, pep_tu_80, pepturnd))
rank79030pvals[1:10]
top_5=as.double(rank79030pvals[1:5])
tm=proc.time()
smpep(ODXs79030pwmsc[1],rndpepchr)
top_5_pred=smpep(ODXs79030pwmsc[top_5],rndpepchr)
top_5pred=unlist(sapply(1:5, function(i){sample(sapply(1:lengths(top_5_pred)[i], function(j){paste(top_5_pred[[i]][[j]],sep="",collapse="")}), 150)}))
c(top_5pred)
length(c(peppostive, pepnegtlo, pep_top_5, pepnegtve, pep_tu_80, pepturnd, top_5pred))
tm=proc.time()
bot_rnd=negsmpep(ODXs79030pwmsc,rndpepchr, n=2000)
print(proc.time()-tm)
bot_rnd
pepnegrnd=unlist(lapply(bot_rnd, function(x){paste(x, collapse="")}))
pepnegrnd
length(c(peppostive, pepnegtlo, pep_top_5, pepnegtve, pep_tu_80, pepturnd, top_5pred))
4290-2737
head(pepnegrnd, 753)
pep2000worst=pepnegrnd
pepnegrnd=head(pepnegrnd, 753)
peprnd=sample(rndpepchr, 800)
peprnd=unlist(lapply(peprnd,function(x){paste(x, collapse = "")}))
peprnd
length(c(peppostive, pepnegtlo, pep_top_5, pepnegtve, pep_tu_80, pepturnd, top_5pred, pepnegrnd, peprnd))
peptotest=data.frame(cbind(peppostive,rep("peppos",length(peppostive))))
peptotest
x=data.frame(cbind(peptop5,rep("pep5",length(peppostive))))
x=data.frame(cbind(pep_top_5,rep("pep5",length(pep_top_5))))
peptotest=rbind(peptotes,x)
peptotest=rbind(peptotest,x)
colnames(peptotest)=c("Sequence","Annotation")
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
peptotest
x=data.frame(cbind(pep_tu_80,rep("peptu",length(pep_tu_80))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
x=data.frame(cbind(pep_tu_80,rep("peptu",length(pep_tu_80))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
length(pep_tu_80)
length(peptotest[peptotest[,2]=="peptu"])
peptotest
peptotest=peptotest[-(1229:1261),]
peptotest
x=data.frame(cbind(pepnegtve,rep("pepneg",length(pepnegtve))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
x=data.frame(cbind(pepnegtlo,rep("pepneglo",length(pepnegtlo))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
x=data.frame(cbind(top_5pred,rep("pep5pred",length(top_5pred))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
peptotest
top_5pred
c(top_5pred)
x=data.frame(cbind(c(top_5pred),rep("pep5pred",length(c(top_5pred))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
peptotest
length(c(top_5pred))
x
x=""
top_5pred
top_5_pred
y=c(top_5pred)
y
x=data.frame(cbind(y,rep("pep5pred",length(y)))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
peptotest
peptotes=peptotest[-1905,]
peptotest
peptotes=peptotest[1:1904,]
peptotest
peptotest
rm(peptotes)
peptotest=peptotest[1:1904,]
rm(peptotes)
peptotest
x=data.frame(cbind(y,rep("pep5pred",length(y))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
peptotest
unique(peptotest[,2])
x=data.frame(cbind(pepturnd,rep("pepturnd",length(pepturnd))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
x=data.frame(cbind(pepnegrnd,rep("pepnegrnd",length(pepnegrnd))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
x=data.frame(cbind(peprnd,rep("peprnd",length(peprnd))))
colnames(x)=c("Sequence","Annotation")
peptotest=rbind(peptotest,x)
peptotest
unique(peptotest[,2])
peptotest0=peptotest
peptotest[,1]=sapply(peptotest[,1], function(x){paste(x,"GGGS", collapse = "", sep = "")})
peptotest
write.table(peptotst,"peptotest.txt")
write.table(peptotest,"peptotest.txt")
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
savehistory("~/BG/NorwayLichtensteinIsland/Execution/exp/DB/240816.Rhistory")
profchk(odx79030Lpwmx[[117]][[1]],rndpepchr[1563456],7)
profchk(odx79030Lpwmx[[117]][[1]],rndpepchr[[1563456]],7)
rank79030pvals[1:5]
rndpODXs79030pwmEv[as.double(rank79030pvals[1:5])]
min(rndpODXs79030pwmEv[rndpODXspwmEv!=0])
min(rndpODXs79030pwmEv[rndpODXspwmEv>0])
min(rndpODXs79030pwmEv[rndpODXs79030pwmEv>0])
ODXs79030scchosen[rndpODXs79030pwmEv==0]
which(ODXs79030scchosen[rndpODXs79030pwmEv==0])
which(rndpODXs79030pwmEv==0)
rndpODXs79030pwmEv=sapply(1:790,function(i){1-pbinom(length(ODXs_790_30[ODXs_790_30[,2]==i,1]/2),224000,rndpODXs79030pwmpv[[i]])})
# chose 790_30 clusters with binomial p of occurrence <0.01 - the idea of consensus clusters was abandoned due to lower number of sselected
# clusters than using the 790_30 alone
chosen79030=rndpODXs79030pwmEv<1e-4
ixchosen=which(chosen79030)
#... and those with p=0
ixsuperhi=which(rndpODXs79030pwmEv==0)
# the peptides of the chosen clusters
ODXs79030pepch=lapply(ixchosen,function(i){ODXs79030pep[[i]]})
# calculate the scores of all peptides according to the pwm of the cluster they belong to
ODXs79030scall=sapply(1:790, function(i){y=strsplit(ODXs_790_30[ODXs_790_30[,2]==(i-1),1], split="");sapply(y,function(x){profchk(odx79030Lpwmx[[i]][[1]],x,7)})})
# ... and those of the chosen
ODXs79030scchosen=ODXs79030scall[chosen79030]
names(ODXs79030scchosen)=ixchosen
# from the peptides of the chosen clusters, select those of the lowest scores...
p=1e-6
pep79030_01=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]<quantile(ODXs79030scchosen[[i]], probs=p)]})
# ... and of the high scores
pep79030_99=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-p))]})
peppostive=unlist(pep79030_99)
pepnegtve=unlist(pep79030_01)
pbinom(length(ODXs_790_30[ODXs_790_30[,2]==10,1]/2
)
pbinom(length(ODXs_790_30[ODXs_790_30[,2]==10,1]/2))
x="ACERFDKFLIPWSER"
y="DKFLIPWSERFGFTF"
strovrl(x,y)
strovrl(x,y)
strovrl(y,x)
y="DKFLIPWSERFGFTF"
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(y,x)
strovrl(x,y)
n
strovrl(x,y)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
Q
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(x,y)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(x,y)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(x,y)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(x,y)
strovrl(y,x)
strovrl(y,x,5)
strovrl(y,x,6)
strovrl(y,x,7)
strovrl(y,x,7)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(y,x)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(y,x)
strovrl(y,x,6)
strovrl(y,x,5)
strovrl(y,x,4)
strovrl(y,x,3)
strovrl(x,y)
strovrl(x,y,3)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(x,y,3)
n
n
strovrl(x,y,3)
strovrl(y,x, 3)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/strovrl.R')
strovrl(y,x, 3)
rank79030pvals
rank79030pvals[order(rank79030pvals)]
rank79030pvals
rank79030pvals=as.double(rank79030pvals)
rank79030pvals
rank79030pvals[order(rank79030pvals)]
rndpODXs79030pwmEv[chosen79030]
rank79030pvals=names(ODXs79030scchosen)[order(rndpODXs79030pwmEv[chosen79030])]
ODXs79030pep[as.double(rank79030pvals[1:6])]
rank79030pvals
rank79030pvals=as.double(rank79030pvals)
rank79030pvals
ODXs79030scchosen[rank79030pvals]
rndpODXs79030pwmEv[chosen79030][order(rndpODXs79030pwmEv[chosen79030])]
psLogo(t(odx79030Lpwmx[rank79030pvals[1:100]]))
psLogo(t(odx79030Lpwmx[[rank79030pvals[1:100]]]))
psLogo(t(odx79030Lpwmx[rank79030pvals[1:100]]))
odx79030Lpwmx[1]
odx79030Lpwmx[[1]]
psLogo(t(odx79030Lpwmx[rank79030pvals[1:100]][[1]]))
psLogo(t(odx79030Lpwmx[rank79030pvals[1:100]][[1]]))
t(odx79030Lpwmx[rank79030pvals[1:100]][[1]]
)
odx79030Lpwmx[rank79030pvals[1:100]][[1]]
odx79030Lpwmx[[rank79030pvals[1:100]]][[1]]
odx79030Lpwmx[rank79030pvals[1]][[1]]
odx79030Lpwmx[[1]][[1]]
sapply(rank79030pvals[1:100],function(x){psLogo(t(odx79030Lpwmx[[x]][[1]]))})
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/psLogo.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/psLogo.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/psLogo.R')
sapply(rank79030pvals[1:100],function(x){psLogo(t(odx79030Lpwmx[[x]][[1]]), paste("Cluster ",x, collapse = ""))})
sapply(rank79030pvals[1:100],function(x){psLogo(t(odx79030Lpwmx[[x]][[1]]), paste("Cluster ",x, collapse = ""))})
interesting_clusters=c("261","258","235","228","224", "218","201","188","181")
interesting_clusters=c(115,61,55,53)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/psLogo.R')
pep_other_4=lapply(interesting_clusters, function(x){i=as.double(x); ODXs79030pep[[i]][ODXs79030scall[[i]]>ODXs79030_sc[[i]]]})
pep_other_4=unlist(pep_other_4)
pep_other_4
pep_other_4=lapply(interesting_clusters, function(x){i=as.double(x); ODXs79030pep[[i]]})
pep_other_4=unlist(pep_other_4)
pep_other_4
rank79030pvals[1:5],
rank79030pvals[1:5]
interesting_clusters
sapply(rank79030pvals[1:5],function(i){psLogo(t(odx79030Lpwmx[[i]][[1]],paste("Cluster ",i,collpase )))
sapply(rank79030pvals[1:5],function(i){psLogo(t(odx79030Lpwmx[[i]][[1]],paste("Cluster ",i,collapse="")))})
sapply(rank79030pvals[1:5],function(i){psLogo(t(odx79030Lpwmx[[i]][[1]]),paste("Cluster ",i,collapse=""))})
interesting_clusters=c(258,115,61,55,53)
pep_other_5=lapply(interesting_clusters, function(x){i=as.double(x); ODXs79030pep[[i]]})
pep_other_5=unlist(pep_other_5)
pep_other_4
pep_other_5
4290+1333
pep_other_5=lapply(interesting_clusters[2:5], function(x){i=as.double(x); ODXs79030pep[[i]]})
pep_other_5=unlist(pep_other_5)
pep_other_5
pep_other_4
pep_other_5=c(pep_other_4,ODXs79030pep[[258]][ODXs79030pep[[258]]>ODXs79030_sc[[258]]]]})
pep_other_5=unlist(pep_other_5)
pep_other_5=c(pep_other_4,ODXs79030pep[[258]][ODXs79030pep[[258]]>ODXs79030_sc[258]])
pep_other_5=unlist(pep_other_5)
pep_other_5
pep_other_5=c(pep_other_4,ODXs79030pep[[258]][ODXs79030pep[[258]]>2*ODXs79030_sc[258]])
pep_other_5=unlist(pep_other_5)
pep_other_5
pep_other_5=c(pep_other_4,ODXs79030pep[[258]][ODXs79030scall[[258]]>ODXs79030_sc[258]])
pep_other_5=unlist(pep_other_5)
pep_other_5
4290+1193
write.table(pep_other_5, "pep_o_5.txt")
interesting_clusters
pep_other_5
View(pepdist)
View(pepdist)
View(pepdist)
View(pepdist)
View(pepdist)
View(clustensus)
View(clustensus)
rm(pepdist)
install.packages("rpud")
library(rpud)
install.packages("C:/Users/Anastas/Desktop/rpud_0.0.2.tar.gz", repos = NULL, type = "source")
install.packages("C:/Users/Anastas/Desktop/rpux_0.6.0_win.zip", repos = NULL, type = "win.binary")
install.packages("C:/Users/Anastas/Desktop/rpux_0.6.0_win/rpux_0.6.0_win/rpud_0.6.0.zip", repos = NULL, type = "win.binary")
install.packages("C:/Users/Anastas/Desktop/rpux_0.6.0_win/rpux_0.6.0_win/rpud_0.6.0_src.zip", repos = NULL, type = "win.binary")
install.packages("C:/Users/Anastas/Desktop/rpux_0.6.0_win/rpux_0.6.0_win/rpudplus_0.6.0.zip", repos = NULL, type = "win.binary")
install.packages("C:/Users/Anastas/Desktop/rpux_0.6.0_win/rpux_0.6.0_win/rpusvm_0.6.0.zip", repos = NULL, type = "win.binary")
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
is.character((rndpep))
is.character((rndpepchr))
is.array(rndpepchr)
is.character((rndpepchr[[1]]))
nchar(rndpep[[1]])
nchar(rndpep[1:0])[[1]]
nchar(rndpep[1:0])
nchar(rndpep[1:10])
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
dist(rnpep[1:10])
dist(rndpep[1:10])
dist(rndpepchr[1:10])
install.packages("peplib")
library("peplib", lib.loc="~/R/win-library/3.3")
akmODXs=aclust(ODXsel[1:3000],4)
akmODXs=aclust(ODXse,4)
akmODXs=aclust(ODXsel,800)
length(ODXsel)
akmODXs=aclust(ODXsel[,1],800)
length(ODXsel[,1])
akmODXs=aclust(ODXsel[,1],10)
akmODXs=aclust(strspli(ODXsel[,1], split=""),10)
akmODXs=aclust(strsplit(ODXsel[,1], split=""),10)
akmODXs=aclust(dist(ODXsel[,1]),10)
akmODXs=aclust(dist(ODXsel[1:10000,1]),10)
b62params <- new("MetricParams", smatrix=blosum62, gapOpen=-8, gapExtension=-5)
b62params <- new("MetricParams", smatrix=data(blosum62), gapOpen=-8, gapExtension=-5)
data("blosum62")
b62params <- new("MetricParams", smatrix=blosum62, gapOpen=-8, gapExtension=-5)
plot(ODXsel[1:1000,1],params=b62params)
data("TULASequences")
rm(TULASequences)
ODXseqs=read.sequences("ODXsel.tx")
ODXseqs=read.sequences("ODXsel.txt")
ODXseqs[1:100]
plot(ODXseq[1:1000],params=b62params)
plot(ODXseqs[1:1000],params=b62params)
plot(ODXseqs,params=b62params)
plot(ODXseqs[1:20000],params=b62params)
pepdist(ODXsel[1:100,1])
pepdist(ODXsel[1:100,1])
x=pepdist(ODXsel[1:100,1])
length(chosen79030)
chosen_more=rndpODXs79030pwmEv<1e-2
length(chosen_more)
chosen_more=rndpODXs79030pwmEv<0.1
length(chosen_more)
rndpODXs79030pwmEv
hist(rndpODXs79030pwmEv)
length(chosen79030[chosen79030])
length(chosen_more[chosen_more])
length(pep79030_99)
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.1))]})
length(pep79030_more)
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.3))]})
length(pep79030_more)
lengths(ODXs79030pepch)
length(unlist(ODXs79030pepch))
quantile(ODXs79030scchosen[[i]], probs=(1-0.3))
quantile(ODXs79030scchosen[[1]], probs=(1-0.3))
pep79030_more
length(unlist(pep79030_more))
length(unlist(pep79030_99))
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.05))]})
length(unlist(pep79030_99))
length(unlist(pep79030_more))
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.025))]})
length(unlist(pep79030_more))
rndpep_5000=sample(rndpep,5000)
pepmore_rnd=c(pep79030_more,rndpep_5000)
length(pepmore_rnd)
pepmore_rnd=unlist(pepmore_rnd)
length(pepmore_rnd)
rndpep_1000=sample(rndpep,1000)
pepmore_rnd=unlist(c(pep79030_more,rndpep_1000))
length(pepmore_rnd)
(5341^2-5341)/2
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.001))]})
length(unlist(pep79030_more))
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.01))]})
length(unlist(pep79030_more))
chosen79030=rndpODXs79030pwmEv<1e-6
ixchosen=which(chosen79030)
length(ixchosen)
chosen79030=rndpODXs79030pwmEv<1e-8
ixchosen=which(chosen79030)
length(ixchosen)
ODXs79030pepch=lapply(ixchosen,function(i){ODXs79030pep[[i]]})
ODXs79030scchosen=ODXs79030scall[chosen79030]
names(ODXs79030scchosen)=ixchosen
pep79030_more=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-0.01))]})
pep79030_more_lo=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=0.1)]})
pep79030_more_lo=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]<quantile(ODXs79030scchosen[[i]], probs=0.01)]})
pep_more=lapply(1:length(ixchosen),function(x){c(pep79030_more[x],pep79030_more_lo[x])})
pep_more
unlist(pep_more)
pepmore_rnd=unlist(c(pep_more,rndpep_1000))
length(pepmore_rnd)
pepmrndist=pepdist(pepmore_rnd)
library("tsne", lib.loc="~/R/win-library/3.3")
pepmrndistOK=as.dist(pepmrndist$D~pepmrndist$P1+pepmrndist$P2)
pepmrndist
pepmrndistOK=as.dist(xtabs(pepmrndist$D~pepmrndist$P1+pepmrndist$P2))
pepmrndistOK
xtabs(x)
xtabs(x$D~x$P1+x$P2)
pepmrndMDS=cmdscale(pepmrndistOK)
plot(pepmrndMDS)
colpepmr=c(rep(2,2940), rep(3,1000))
plot(pepmrndMDS, colpepmr)
lengths(pepmrndMDS)
dim(pepmrndMDS)
colpepmr=c(rep(2,2939), rep(3,1000))
plot(pepmrndMDS, colpepmr)
pepmrndMDS
plot(pepmrndMDS, col=colpepmr)
pepmrndMDS=cmdscale(pepmrndistOK, k=100, eig = TRUE)
pepmrndMDS$eig
plot(pepmrndMDS$points[,1:2], col=colpepmr)
pepmrndMDS4=pepmrndMDS$points[,c(1,2,7,10)]
pepmrndtsne=tsne(pepmrndMDS4, initial_dims = 4)
plot(pepmrndtsne)
plot(pepmrndtsne, col=colpepmr)
pep_more
pepmore=lapply(pep_more,unlist)
pepmore
pepmoreL=lengths(pepmore)
pepmoreL
sum(pepmoreL)
pepmoreL=c(pepmoreL,1000)
pepmoreL
colspepmore=lapply(1:469,function(i){rep(i,pepmoreL[i])})
colspepmore
rep(1,6)
pepmorel[1]
colspepmore=sapply(1:469,function(i){rep(i,pepmoreL[i])})
colspepmore=unlist(colspepmore)
install.packages("RColorBrewer")
library(RColorBrewer)
n <- 60
qual_col_pals = brewer.pal.info[brewer.pal.info$category == 'qual',]
col_vector = unlist(mapply(brewer.pal, qual_col_pals$maxcolors, rownames(qual_col_pals)))
pie(rep(1,n), col=sample(col_vector, n))
cols=c(colspepmore[1:100]+1,rep(18,358),rep(1,1000))
cols=colspepmore
cols[57:2940]=13
cols[2940:3940]=14
plot(pepmrndtsne[1:56,], col=col_vector[1:56])
plot(pepmrndtsne[1:56,], col=col_vector[cols[1:56]])
plot(pepmrndtsne[1:2940,], col=col_vector[cols[1:2940]])
plot(pepmrndtsne[1:56,], col=col_vector[cols[1:56]], xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))
rm(colpepmr)
lengths(pep79030_more)
pepmoreL
colspepmoreHL=lapply(1:468,function(i){c(rep(1,pepmoreL[i]/2,rep(2,pepmoreL[i]/2)})
colspepmoreHL=lapply(1:468,function(i){c(rep(1,pepmoreL[i]/2,rep(2,pepmoreL[i]/2)))})
Warnings()
warnings()
colspepmoreHL=lapply(1:468,function(i){c(rep(1,pepmoreL[i]/2),rep(2,pepmoreL[i]/2))})
colspepmoreHL
colspepmoreHL=unlist(c(colspepmoreHL,3))
plot(pepmrndtsne[1:56,], col=col_vector[colspepmoreHL], xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1:56,], col=colspepmoreHL, xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne, col=colspepmoreHL, xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))
colspepmoreHL=unlist(c(colspepmoreHL,rep(3,999)))
plot(pepmrndtsne, col=colspepmoreHL, xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))
pepmoreL
sapply(2:468, function(i){j=pepmoreL[i];s=sum(pepmoreL[1:(i-1]));plot(pepmrndtsne[s:(s+j),], col=(c(rep(j/2,1),rep(j/2,2))), xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]));par(new=TRUE)})
sapply(2:468, function(i){j=pepmoreL[i];s=sum(pepmoreL[1:(i-1)]);plot(pepmrndtsne[s:(s+j),], col=(c(rep(j/2,1),rep(j/2,2))), xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))})
sapply(2:468, function(i){j=pepmoreL[i];s=sum(pepmoreL[1:(i-1)]);plot(pepmrndtsne[(s+1):(s+j),], col=(c(rep(1,j/2),rep(2,j/2))), xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))})
sapply(2:10, function(i){j=pepmoreL[i];s=sum(pepmoreL[1:(i-1)]);plot(pepmrndtsne[(s+1):(s+j),], col=(c(rep(1,j/2),rep(2,j/2))), xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))})
plot(pepmrndtsne, col=colspepmoreHL, xlim=range(pepmrndtsne[,1]), ylim=range(pepmrndtsne[,2]))
x=which(pepmrndtsne[,1]<52 & pepmrndtsne[,1]<52 & pepmrndtsne[,2]>-50 & pepmrndtsne[,1]<-48)
x=which(pepmrndtsne[,1]<52 & pepmrndtsne[,1]<52 & pepmrndtsne[,2]> -50 & pepmrndtsne[,1]< -48)
x
x=which(pepmrndtsne[,1]<52 & pepmrndtsne[,1]>50 & pepmrndtsne[,2]> -50 & pepmrndtsne[,2]< -48)
x
pep_more
unlist(pepmore)[x]
pep79030_more=lapply(1:7, function(i){ODXs79030pepch[[i]]})
pep_more=unlist(c(pep79030_more,rndpep_1000))
pep_more
pepmrndist=pepdist(pep_more)
pepmrndistOK=as.dist(xtabs(pepmrndist$D~pepmrndist$P1+pepmrndist$P2))
pepmrndMDS=MDS(pepmrndistOK)
pepmrndMDS=cmdscale(pepmrndistOK)
plot(pepmrndMDS)
pepmrndMDS=cmdscale(pepmrndistOK, k=12)
colpepmr=c(rep(2,2939), rep(3,1000))
lengths(pep79030_more)
Ls=lengths(pep79030_more)
Ls=c(Ls,1000)
LS
Ls
colpepmr=sapply(1:8,function(i){rep(i,Ls[i])})
colpepmr
colpepmr=unlist(colpepmr)
colpepmr
plot(pepmrndMDS, colpepmr)
plot(pepmrndMDS[,1:2], colpepmr)
pepmrndMDS=cmdscale(pepmrndistOK, k=12, eig = TRUE)
lengths(colpepmr)
length(colpepmr)
length(pep_more)
length(pepmrndistOK)
length(pepmrndMDS$points[,1])
colpepmr=colpepmr[2:2826]
plot(pepmrndMDS$points[,1:2], col=colpepmr)
library("tsne", lib.loc="~/R/win-library/3.3")
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 8)
plot(pepmrndtsne)
plot(pepmrndtsne, col=colpepmr)
colpepmr
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
pepmrndist=pepdist(pep_more)
pepmrndistOK=as.dist(xtabs(pepmrndist$D~pepmrndist$P1+pepmrndist$P2))
pepmrndtsne=tsne(pepmrndistOK)
library("tsne", lib.loc="~/R/win-library/3.3")
pepmrndtsne=tsne(pepmrndistOK)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
pepmrndist=pepdist(pep_more)
length(is.na(pepmrndist))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
pepmrndist=pepdist(pep_more)
length(is.na(pepmrndist))
length(is.na(pepmrndist$D))
length((pepmrndist$D))
length(pepmrdist$D[is.na(pepmrndist$D)])
length(pepmrndist$D[is.na(pepmrndist$D)])
hist(pepmrndist$D, breaks = 500)
pepmrndist[pepmrndist$D<0.5,]
pepmrndist[pepmrndist$D<0.5,][order(pepmrndist$D),]
pepmrndist[pepmrndist$D<0.5,][order(pepmrndist$D),]
x=pepmrndist[pepmrndist$D<0.5,]
x[order(x$),]
x[order(x$D),]
head(x[order(x$D),])
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
pepmrndist=pepdist(pep_more)
length(pepmrndist$D[is.na(pepmrndist$D)])
hist(pepmrndist$D, breaks = 500)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pepdist.R')
pepmrndist=pepdist(pep_more)
length(pepmrndist$D[is.na(pepmrndist$D)])
hist(pepmrndist$D, breaks = 500)
install.packages("spaa")
library("spaa", lib.loc="~/R/win-library/3.3")
list2dist(y)
pepmrndtsne=tsne(pepmrndistOK)
library("tsne", lib.loc="~/R/win-library/3.3")
pepmrndtsne=tsne(pepmrndistOK)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
tm=proc.time()
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 7, perplexity = 5)
print(proc.time()-tm)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
tm=proc.time()
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 7, perplexity = 10)
print(proc.time()-tm)
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
tm=proc.time()
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 7, perplexity = 15)
print(proc.time()-tm)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
tm=proc.time()
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 7, perplexity = 5)
print(proc.time()-tm)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
tm=proc.time()
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 14, perplexity = 10)
print(proc.time()-tm)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
pep_more
pep_more[pepmrndtsne[,1]<50 & pepmrndtsne[,1]>25 & pepmrndtsne[,2]>50 & pepmrndtsne[,1]<75]
pep_more[pepmrndtsne[,1]<0 & pepmrndtsne[,1]>-25 & pepmrndtsne[,2]>75 & pepmrndtsne[,1]<100]
pep_more[pepmrndtsne[,1]<-50 & pepmrndtsne[,1]>-80 & pepmrndtsne[,2]>-40 & pepmrndtsne[,1]<0]
plot(pepmrndtsne, col=colpepmr, cex=0.6)
plot(pepmrndtsne, col=colpepmr)
pepmrndtsne=tsne(pepmrndistOK, initial_dims = 12, perplexity = 12)
plot(pepmrndtsne, col=colpepmr)
plot(pepmrndtsne, col=colpepmr, cex=0.6)
plot(pepmrndtsne[1825:2825,], col=colpepmr[1825:2825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1:522,], col=colpepmr[1:522],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[523:1115,], col=colpepmr[523:1115],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
plot(pepmrndtsne[1116:1825,], col=colpepmr[1116:1825],xlim=range(pepmrndtsne[,1]),ylim=range(pepmrndtsne[,2]))
rndpep
pepord0=sample(rndpep, 2970)
pepord0=lapply(pepord0, function(x){paste(x,"GGGS", collapse="", sep="")})
pepord0
pepord0=unlist(pepord0)
pepord0
length(ODXs79030pepch)
rndpepchr
length(rndpepchr)
attr(pep79030_shi, "Descr.")="Super High"
attr(pep79030_shi, "Descr.")="Super High - see ixsuperhi - those when rndpODXs79030pwmEv==0"
attr(ODXs_790_30, "Descr.")="Clustering of the ODXsel in 790 Gibb's clusters with 30 rounds, ODXs_790_30[,2] is cluster assignment"
View(odx79030pwmx)
save(odx79030pwmx,"odx79030pwmx")
save(odx79030pwmx,file="odx79030pwmx")
save(ixchosen,"ixchosen")
save(ixchosen,file="ixchosen")
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Prdct/findmaxscore.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Prdct/profchk.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Prdct/profchk.R')
save(odx79030Lpwmx,file="odx79030Lpwmx")
aa
save(aa,file="aa")
filepr("c1/", sh=T)
mapFile="mappall.csv"
dirToParse=pfx
cn=c("YPYDVPDYAG", "DYKDDDDKAS")
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile)
c1v0=c1pSet@assayData$exprs
pfx="chf5_"
require(pepStat)
require(limma)
require(Biobase)
mapFile="mappall.csv"
dirToParse=pfx
cn=c("YPYDVPDYAG", "DYKDDDDKAS")
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile)
c1v0=c1pSet@assayData$exprs
mapFile="mapall.csv"
dirToParse=pfx
cn=c("YPYDVPDYAG", "DYKDDDDKAS")
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile)
c1v0=c1pSet@assayData$exprs
View(c1v0)
c1v0
c1pSet@featureData@data
c1pSet@annotation
c1pSet@protocolData@data
View(c1pSet@protocolData@data)
c1pSet@featureData@data
library("pepStat", lib.loc="~/R/win-library/3.3")
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE)
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE)
c1v0=c1pSet@assayData$exprs
c1pSet@assayData$exprs
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE)
c1v0=c1pSet@assayData$exprs
dim(c1v0)
View(c1v0)
c1pnSet=normalizeArray(c1pSet)
View(c1v0)
c1pepts=c1pSet@featureRange@elementMetadata@listData$peptide
c1pepts
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE)
c1v0=c1pSet@assayData$exprs
c1pepts=c1pSet@featureRange@elementMetadata@listData$peptide
c1pnSet=normalizeArray(c1pSet)
c1v=c1pnSet@assayData$exprs
c1ncol=ncol(c1v)
rownames(c1v)=c1pepts
c1v0=baseline_correct(c1pSet)
detach("package:pepStat", unload=TRUE)
library("pepStat", lib.loc="~/R/win-library/3.3")
c1v0=baseline_correct(c1pSet)
summary(c1pSet)
flagged_c1=is.na(c1v0[,1])|is.na(c1v0[,2])
length(flagged_c1[flagged_c1])
c1pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = FALSE)
c1v0=c1pSet@assayData$exprs
c1pepts=c1pSet@featureRange@elementMetadata@listData$peptide
c1pnSet=normalizeArray(c1pSet)
c1v=c1pnSet@assayData$exprs
is.na(c1v0[,1])|is.na(c1v0[,2])
all(is.na(c1v0[,1])|is.na(c1v0[,2]))
all(!is.na(c1v0[,1])|!is.na(c1v0[,2]))
c1pnSet
length(c1v)
c1v=c1pnSet@assayData$exprs
c1v=c1v[,1]-c1v[,2]
names(c1v)=c1pepts
length(c1v)
c1gr=c1pSet@featureRange@elementMetadata@listData$featureID
c1gr=as.factor(c1gr)
c1df=as.data.frame(cbind(c1v,c1gr))
c1df=c1df[!flagged_c1,]
aggregate(c1df[,1], as.list(rownames(c1df)), mean)
length(unique(rownames(cqdf)))
length(unique(rownames(c1df)))
length(unique(rownames(c1pepts)))
c1pepts
length(unique((c1pepts)))
rownames(c1df)
c1v=c1pnSet@assayData$exprs
c1v=c1v[,1]-c1v[,2]
c1df=as.data.frame(cbind(c1v,c1gr, c1pepts))
c1df=c1df[!flagged_c1,]
aggregate(c1df, c1df[,3], mean)
c1df[,3]
aggregate(c1df, as.list(c1df[,3]), mean)
as.list(c1df[,3])
c1df=data.frame(c1v,c1gr, c1pepts, stringsAsFactors = FALSE)
View(c1df)
x=aggregate(c1v~c1pepts, data=c1df, FUN="mean")
c1dfagg=aggregate.data.frame(c1df, as.list(c1df[,3]), FUN="mean")
as.list(c1df[,3]
)
length(as.list(c1df[,3])
)
c1dfagg=aggregate(c1df, as.list(c1df[,3]), FUN="mean")
c1dfagg=aggregate(c1df, c1pepts, FUN="mean")
c1dfagg=aggregate(c1df[,1], c1pepts, FUN="mean")
c1dfagg=aggregate(c1df[,1], as.list(c1pepts), FUN="mean")
length(c1df[,1])
length(as.list(c1pepts))
c1dfagg=aggregate(c1df, list(c1gr, c1pepts), mean)
c1dfagg
View(c1dfagg)
c1dfagg[,-c(4,5)]
colnames(c1dfagg)=c("Group","Peptide", "c1v")
View(c1dfagg)
c1dfagg=c1dfagg[,1:3]
boxplot(c1c~group,c1dfagg )
boxplot(c1v~group,c1dfagg )
boxplot(c1v~Group,c1dfagg )
hist(c1v. breaks=300)
hist(c1v, breaks=300)
c1pnSet=normalizeArray(c1pSet, centered = FALSE)
c1v=c1pnSet@assayData$exprs
c1v=c1v[,1]-c1v[,2]
names(c1v)=c1pepts
rm(c1v)
c1v=c1pnSet@assayData$exprs
c1v=c1v[,1]-c1v[,2]
c1df=as.data.frame(cbind(c1v,c1gr, c1pepts))
c1df=data.frame(c1v,c1gr, c1pepts, stringsAsFactors = FALSE)
c1dfagg=aggregate(c1df, list(c1gr, c1pepts), mean)
warnings()
length(c1dfagg[is.na(c1dfagg[,1])])
View(c1dfagg)
length(c1dfagg[is.na(c1dfagg[,3])])
c1dfagg=c1dfagg[,1:3]
c1dfsd=aggregate(c1df, list(c1gr, c1pepts), sd)
View(c1dfsd)
c1dfsd=c1dfsd[,1:3]
hist(c1dfagg[,3], breaks=300)
hist(c1dfagg[c1dfagg[,1]==peppos,3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="peppos",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="peprnd",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="pepotehr5",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="pepother5",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="pepneg",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="pepneglo",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="peptu",3], breaks=300)
hist(c1dfagg[c1dfagg[,1]=="pep5",3], breaks=300)
c1crit=c1dfsd[,3]/c1dfagg[,3]
hist(c1crit, breaks=300)
c1crfl=c1crit<0.3
c1dfaggflt=c1dfagg[c1crfl]
c1dfaggflt=c1dfagg[c1crfl,]
View(c1dfagg)
rownames(c1dfagg)=c("Group", "Peptide", "c1v")
colnames(c1dfagg)=c("Group", "Peptide", "c1v")
colnames(c1dfaggflt)=c("Group", "Peptide", "c1v")
boxplot(c1v~Group, c1dfaggflt)
boxplot(c1v~Group, c1dfaggflt, notch=TRUE, varwidth=TRUE)
flphd=c1dfaggflt %in% c("pep5", "pepneg", "pepneglo","pepnegrnd","pepother5","peppos")
hist(c1dfaggflt[flphd,3], breaks=300)
flphd
flphd=c1dfaggflt[,1] %in% c("pep5", "pepneg", "pepneglo","pepnegrnd","pepother5","peppos")
flphd
hist(c1dfaggflt[flphd,3], breaks=300)
hist(c1dfaggflt[c1dfaggflt[,1]=="peprnd",3], breaks=300)
nrow(c1dfaggflt)
c1glm=glm(c1v~Group, data = c1dfaggflt)
summary(c1glm)
c1pSet@assayData$exprs
c1v=log2(2^(c1v)[,1]-2^(c1v)[,2])
c1df=data.frame(c1v,c1gr, c1pepts, stringsAsFactors = FALSE)
c1dfagg=aggregate(c1df, list(c1gr, c1pepts), mean)
c1dfagg=c1dfagg[,1:3]
c1dfsd=aggregate(c1df, list(c1gr, c1pepts), sd)
c1dfsd=c1dfsd[,1:3]
c1crit=c1dfsd[,3]/c1dfagg[,3]
c1crfl=c1crit<0.3
c1dfaggflt=c1dfagg[c1crfl,]
colnames(c1dfaggflt)=c("Group", "Peptide", "c1v")
boxplot(c1v~Group, c1dfaggflt, notch=TRUE, varwidth=TRUE)
mapFile="mapc1.csv"
dirToParse=pfx
#cn=c("YPYDVPDYAG", "DYKDDDDKAS")
c4pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c4v0=c4pSet@assayData$exprs
#c4pepts=c4pSet@featureRange@elementMetadata@listData$peptide
#rownames(c4v0)=c4pepts
narows=apply(c4v0, 1, function(x){all(!is.na(x))})
c4pSetn=c4pSet[narows,]
c4peptsn=c4pSetn@featureRange@elementMetadata@listData$peptide
c4pnSet=normalizeArray(c4pSetn)
c4v=c4pnSet@assayData$exprs
c4ncol=ncol(c4v)
rownames(c4v)=c4peptsn
View(c4v)
c4gr=c4pSetn@featureRange@elementMetadata@listData$featureID
c4vn=normalizeCyclicLoess(c4v, iterations=3, method="affy")
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz/crg.R')
crg(c4v)
crg(c4vn)
library("limma", lib.loc="~/R/win-library/3.3")
c4vn=normalizeCyclicLoess(c4v, iterations=3, method="affy")
crg(c4vn)
crg(c4v)
crg(c4v0)
crg(c4vn[c4gr=="peppos",])
c4gr
c4pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c4v0=c4pSet@assayData$exprs
#c4pepts=c4pSet@featureRange@elementMetadata@listData$peptide
#rownames(c4v0)=c4pepts
narows=apply(c4v0, 1, function(x){all(!is.na(x))})
c4pSetn=c4pSet[narows,]
c4peptsn=c4pSetn@featureRange@elementMetadata@listData$peptide
c4gr=c4pSetn@featureRange@elementMetadata@listData$featureID
c4pnSet=normalizeArray(c4pSetn)
c4v=c4pnSet@assayData$exprs
c4ncol=ncol(c4v)
rownames(c4v)=c4peptsn
c4vn=normalizeCyclicLoess(c4v, iterations=3, method="affy")
crg(c4vn[c4gr=="peppos",])
crg(c4vn[c4gr=="peprnd",])
c4gr
unique(c4gr)
crg(c4vn[c4gr=="peptu",])
crg(c4vn[c4gr=="pepturnd",])
crg(c4vn[c4gr=="peptneq",])
crg(c4vn[c4gr=="pepneq",])
crg(c4vn[c4gr=="pepneg",])
c4Mean=rowMeans(c4vn)
library("matrixStats", lib.loc="~/R/win-library/3.3")
c4SD=rowSds(c4vn)
plot(c4Mean,c4SD)
c4pnSet=normalizeArray(c4pSetn, centered = FALSE)
c4v=c4pnSet@assayData$exprs
c4ncol=ncol(c4v)
rownames(c4v)=c4peptsn
c4vn=normalizeCyclicLoess(c4v, iterations=3, method="affy")
plot(c4Mean,c4SD)
c4_SD=rowSds(c4v)
c4_Mean=rowMeans(c4v)
plot(c4_Mean,c4_SD)
c4pp=lapply(c4peptsn,function(x){x})
c4df=DataFrame(cbind(c4vn, c4pp))
c4nms=c(c4nms, "pp")
c4vndf=data.frame(matrix(unlist(c4vndf), nrow=nrow(c4vndf)),stringsAsFactors = FALSE)
c4vndf[,1:4]=as.numeric(c4vndf[,1:4])
c4vndf[,1]=as.numeric(c4vndf[,1])
c4vndf[,2]=as.numeric(c4vndf[,2])
c4vndf[,3]=as.numeric(c4vndf[,3])
c4vndf[,4]=as.numeric(c4vndf[,4])
colnames(c4vndf)=c4nms
c4va=aggregate(c4vndf[,1:4],list(c4vndf$pp),"mean")
View(c4vn)
c4vn=normalizeCyclicLoess(c4va, iterations=3, method="affy")
c4vn=normalizeCyclicLoess(c4va, iterations=3, method="affy")
View(c4va)
rownames(c4va)=c4va$Group.1
c4va=c4va[,-1]
c4vn=normalizeCyclicLoess(c4va, iterations=3, method="affy")
c4vn=normalizeCyclicLoess(c4va, iterations=3, method="affy")
c4Mean=rowMeans(c4vn)
c4SD=rowSds(c4vn)
plot(c4Mean,c4SD)
c4gr=cbind(c4pSetn@featureRange@elementMetadata@listData$featureID,c4peptsn)
View(c4gr)
c4gr=unique(cbind(c4pSetn@featureRange@elementMetadata@listData$featureID,c4peptsn))
length(c4gr)
nrow(c4gr)
nrow(c4va)
c4gr=unique(data.frame(class=c4pSetn@featureRange@elementMetadata@listData$featureID,pep=c4peptsn))
View(c4gr)
c4gr[duplicated(c4gr$pep),]
c4dupp=c4gr[duplicated(c4gr$pep),2]
c4gr[c4gr$pep %in% c4dupp,]
c4duppp=c4gr[c4gr$pep %in% c4dupp,]
c4duppp[order(c4duppp[,2]),]
View(c4va)
c4vn=normalizeCyclicLoess(c4va, iterations=3, method="affy")
c4Mean=rowMeans(c4vn)
c4SD=rowSds(c4vn)
c4vn=normalizeCyclicLoess(c4va, iterations=3, method="affy")
c4Mean=rowMeans(c4vn)
c4SD=rowSds(c4vn)
plot(c4Mean,c4SD)
c4duppp
c4gr
c4gr[c4gr$pep %in% c4dupp,1]=X
c4gr[c4gr$pep %in% c4dupp,1]="X"
c4gr[c4gr$pep %in% c4dupp,1]="X"
View(c4gr)
plot(c4Mean,c4SD, col=c4gr[,1])
c4gr[,1]
c4gr[c4gr$rownames(c4vn)
c4gr[c4gr$pep==rownames(c4vn),]
c4vagr=lapply(rownames(c4vn),function(x){c4gr[c4gr$pep==x,]}]
c4vagr=lapply(rownames(c4vn),function(x){c4gr[c4gr$pep==x,]})
View(c4vagr)
c4vagr=t(sapply(rownames(c4vn),function(x){c4gr[c4gr$pep==x,]}))
View(c4vagr)
rownames(c4vagr)
View(c4vn)
c4va=aggregate(c4vndf[,1:4],list(c4vndf$pp),"mean")
c4vagr=t(sapply(rownames(c4vn),function(x){c4gr[c4gr$pep==x,]}))
c4vagr=c4vagr[,1]
c4vagr1=lapply(c4vagr, function(x){x[1]})
c4MnSD=data.frame(unlist(c4Mean), unlist(c4SD), unlist(c4vagr1), stringsAsFactors = FALSE)
colnames(c4MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c4MnSD))
boxplot(Mean~Class, data=c4MnSD)
boxplot(SD~Class, data=c4MnSD)
boxplot(log(SD)~Class, data=c4MnSD)
c4CV=c4SD/c4Mean
c4MnSD=cbind(c4MnSD,c4CV)
View(c4MnSD)
boxplot(c4CV~Class, data=c4MnSD)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pepneglo"))
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pepneglo")+1)
plot(c4MnSD$Mean,log(c4MnSD$c4CV),col=(c4MnSD$Class=="pepneglo")+1)
plot(c4MnSD$Mean,log(c4MnSD$c4CV),col=(c4MnSD$Class=="pepneglo"))
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pepneg")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="peppos")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="peprndneg")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pepnegrnd")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pep5")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pepother5")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class %in% c("pepother5","pep5","peppos"))+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class %in% c("pepneg","pepneglo"))+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class %in% c("pepneg","pepneglo")))
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pepother5")+(c4MnSD$Class=="pep5rnd")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pep5")+(c4MnSD$Class=="pep5rnd")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pep5")+(c4MnSD$Class=="pep5rnd"))
plot(c4MnSD$Mean,c4MnSD$c4CV,col=1+(c4MnSD$Class=="pep5rnd"))
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pep5")+(c4MnSD$Class=="pep5pred")+1)
plot(c4MnSD$Mean,c4MnSD$c4CV,col=1+(c4MnSD$Class=="pep5pred"))
plot(c4MnSD$Mean,c4MnSD$c4CV,col=(c4MnSD$Class=="pep5")*1+(c4MnSD$Class=="pep5pred")*1+1)
View(c4vn)
colnames(c4vn)[4]="AI_m"
c4dsn<-c(1,2,1,2)
colnames(c4vndf)[4]="AI_m"
c4peptsn=c4va$Group.1
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/algsmall.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/algsmall.R')
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/algsmall.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/algsmall.R')
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/algsmall.R')
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitallL.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitallL.R')
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
d3heatmap(c4vn, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
tc4=table(c4MnSD$Class,c4_cls$flag)
tc4[,2]/tc4[.1]
tc4[,2]/tc4[,1]
d3heatmap(c4vn[c4MnSD$recl=="clpos"], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
View(c4MnSD)
recl=c4MnSD$Class
recl[recl=="peppos"|recl=="pep5"|recl=="pepother5"]=clpos
recl[recl=="peppos"|recl=="pep5"|recl=="pepother5"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"]="clneg"
unique(c4MnSD$Class)
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c4MnSD=cbind(c4MnSD, recl)
c4dsn=c(1,2,1,3)
c4_cls=algsmall(c4vn, c4dsn, p=c(3.9983e-8, 4.5e-8), pp=c4peptsn)
c4_cls=algsmall(c4vn, c4dsn, p=c(5e-9, 9e-8, 9e-8), pp=c4peptsn)
c4cor=cor(t(c4vn))
image(dim(c4cor), c4cor)
dim(c4cor)
image(1:ncol(c4cor), 1:ncol(c4cor), c4cor)
library("corrplot", lib.loc="~/R/win-library/3.3")
c4cor_hcl=hclust(as.dist(1-abs(c4cor)), method="ward.D2")
c4cor_hcl
c4cor_hcl$merge
c4cor_hcl$order
plot(c4cor_hcl)
c4corord=c4cor[order(c4cor_hcl$order),order(c4cor_hcl$order)]
img0=acast(c4corord, R~C, value.var = "V")
image(img0, zlim=c(-1,1), col=topo.colors(128))
library(reshape2)
img0=acast(c4corord, R~C, value.var = "V")
image(img0, zlim=c(-1,1), col=topo.colors(128))
image(c4corord)
c4corord=c4cor[c4cor_hcl$order,c4cor_hcl$order]
image(c4corord)
c4cor_pca=prcomp(c4cor)
c4cor_pca$sdev
c4corclassMn=sapply(unique(c4MnSD$Class), function(x){mean(c4cor[c4MnSD==x,c4MnSD==x])})
unique(c4MnSD$Class)
c4corclassMn=lapply(unique(c4MnSD$Class), function(x){mean(c4cor[c4MnSD==x,c4MnSD==x])})
c4corclassMn=lapply(unique(c4MnSD$Class), function(x){mean(c4cor[c4MnSD$Class==x,c4MnSD$Class==x])})
c4classMn=lapply(unique(c4MnSD$Class), function(x){mean(c4Mean[c4MnSD$Class==x,c4MnSD$Class==x])})
c4classMn=lapply(unique(c4MnSD$Class), function(x){mean(c4Mean[c4MnSD$Class==x])})
plot(c4classMn,c4corclassMn)
text(c4classMn,c4corclassMn, labels = names(c4classMn))
plot(c4classMn,c4corclassMn)
c4corclassMn=lapply(unique(c4MnSD$Class), function(x){x=mean(c4cor[c4MnSD$Class==x,c4MnSD$Class==x])})
c4corclassMn
c4corclassMn=lapply(as.character(unique(c4MnSD$Class)), function(x){x=mean(c4cor[c4MnSD$Class==x,c4MnSD$Class==x])})
c4corclassMn
classes=as.character(unique(c4MnSD$Class))
classes
c4corclassMn=lapply(classes, function(x){x=mean(c4cor[c4MnSD$Class==x,c4MnSD$Class==x])})
c4corclassMn
names(c4corclassMn)=classes
c4corclassMn
mean(c4cor[c4MnSD$Class=="x"peppos"",c4MnSD$Class=="peppos"])})
mean(c4cor[c4MnSD$Class="peppos"",c4MnSD$Class=="peppos"])})
mean(c4cor[c4MnSD$Class="peppos",c4MnSD$Class=="peppos"])})
mean(c4cor[c4MnSD$Class="peppos",c4MnSD$Class=="peppos"])
mean(c4cor[c4MnSD$Class=="peppos",c4MnSD$Class=="peppos"])
mean(c4cor[c4MnSD$Class=="peprnd",c4MnSD$Class=="peprnd"])
mean(c4cor[c4MnSD$Class=="pep5pred",c4MnSD$Class=="pep5pred"])
plot(c4classMn,c4corclassMn)
text(c4classMn,c4corclassMn, labels = classes)
View(c4MnSD)
c4corclassMn
plot(log(c4classMn),log(c4corclassMn))
plot(c4classMn,log(c4corclassMn)
)
plot(c4classMn,log(as.double(c4corclassMn)))
text(c4classMn,log(as.double(c4corclassMn), labels = classes)
)
text(c4classMn,log(as.double(c4corclassMn)), labels = classes))
text(c4classMn,log(as.double(c4corclassMn)), labels = classes)
View(gprLNSVM)
View(gprLNSVM)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
lf=list.files()
lf
library("stringr", lib.loc="~/R/win-library/3.3")
str_match(lf,".txt")
!is.na(str_match(lf,".txt"))
lf(!is.na(str_match(lf,".txt")))
lf[!is.na(str_match(lf,".txt"))]
str_extract(lf,"(?=_)")
str_extract(lf,"\\(?=_)")
str_extract(lf,"\(?=_)")
str_extract(lf,"\b(?=_)")
str_extract(lf,"\\b(?=_)")
str_extract(lf,"\\b(?=_)")
str_extract(lf,"b(?=.txt)")
str_extract(lf,"b(?=.)")
str_extract(lf,"b(?=\\.)")
str_extract(lf,"b(?=//.)")
str_extract(lf,"b(?=/.)")
str_extract(lf,"b(?=\.)")
str_extract(lf,"b(?=\\.)")
str_extract(lf,"b(?="."")")
str_extract(lf,"b(?=".")")
str_extract(lf,"(?=\\.)")
str_extract(lf,"\\W(?=\\.)")
str_extract(lf,"\\D(?=\\.)")
str_extract(lf,"\\b(?=\\.)")
str_extract(lf,"\\W(?=\\.)")
str_extract(lf,"\\w(?=\\.)")
str_extract(lf,"\\w(?<=\\.)")
str_extract(lf,"(?<=\\.)")
str_extract(lf,"(?=\\.)")
str_extract(lf,"\\w+(?=\\.)")
str_extract(lf,"\\w+(?<=\\.)")
str_extract(lf,"(?<=\\.)\\w+")
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
filepr("c10/", sh=F)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
grpLNSVM("7m03_pre.gpr", p="c10/")
gprLNSVM("7m03_pre.gpr", p="c10/")
gprLNSVM("7m05JT_pre.gpr", p="c10/", shw=TRUE)
gprLNSVM("7m05JT_post.gpr", p="c10/", shw=TRUE)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
gprLNSVM("7m05JT_post.gpr", p="c10/", shw=TRUE)
fcn
fcn
str_match,"635"
str_match(fcn,"635")
str_match(fcn,"532")
all(is.na(str_match(fcn,"635")))
all(is.na(str_match(fcn,"532")))
fcn
class
c4classMn
c4_cls
c4gr
nroe(c4gr)
nrow(c4gr)
c10classes=read.csv("Classes.csv")
View(c10classes)
c10classes=c10classes[,-1]
c10classes=read.csv("Classes.csv", stringsAsFactors = FALSE)
c10classes=c10classes[,-1]
dim(c10classes)
View(c10classes)
c10classes
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/postpre.R')
mapFile="mapc10.csv"
dirToParse="proc_c10_class"
#cn=c("YPYDVPDYAG", "DYKDDDDKAS")
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c10pSet=c10pSet[c10]
#rownames(c10v0)=c10pepts
c10pSet=c10pSet[!is.na(c10pSet@featureRange@elementMetadata@listData$featureID),]
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10peptsn=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10peptsn, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10ncol=ncol(c10v)
#rownames(c10v)=c10peptsn
colnames(c10v)=c10cnm
pp=lapply(c10peptsn,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
colnames(c10vndf)=c10nms
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=3, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=t(sapply(rownames(c10vn),function(x){c10gr[c10gr$pep==x,]}))
c10vagr=c10vagr[,1]
c10vagr1=lapply(c10vagr, function(x){x[1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr1), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD)
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE)
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
require(pepStat)
require(limma)
require(Biobase)
require(matrixStats)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c10pSet=c10pSet[c10]
#rownames(c10v0)=c10pepts
c10pSet=c10pSet[!is.na(c10pSet@featureRange@elementMetadata@listData$featureID),]
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10peptsn=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10peptsn, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10ncol=ncol(c10v)
#rownames(c10v)=c10peptsn
colnames(c10v)=c10cnm
pp=lapply(c10peptsn,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
colnames(c10vndf)=c10nms
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=3, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=t(sapply(rownames(c10vn),function(x){c10gr[c10gr$pep==x,]}))
c10vagr=c10vagr[,1]
c10vagr1=lapply(c10vagr, function(x){x[1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr1), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD)
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE)
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
View(c10vndf)
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
View(c10MnSD)
plot(c10MnSD[,1:2])
plot(log(c10MnSD[,1:2]))
exp(2.35)
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn-10,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-10))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-10))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-min(c10vn)))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-min(c10vn)))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
plot(log(c10MnSD[,1:2]),col=c10MnSD)
plot(log(c10MnSD[,1:2]),col=as.factor(c10MnSD[,4]))
plot(log(c10MnSD[,1:2]),col=(c10MnSD[,4]==clpos)+1)
plot(log(c10MnSD[,1:2]),col=(c10MnSD[,4]=="clpos")+1)
plot(log(c10MnSD[,1:2]),col=(c10MnSD[,4]=="clneg")+1)
plot(log(c10MnSD[,1:2]),col=(c10MnSD[,4]=="peprnd")+1)
plot(log(c10MnSD[,1:2]),col=(c10MnSD[,4]=="pepnegrnd")+1)
plot(log(c10MnSD[c10MnSD[,4]=="pepnegrnd",1:2]),xlim=range(c10MnSD[,1]),ylim=range(c10MnSD[,2]))
plot(log(c10MnSD[c10MnSD[,4]=="pepnegrnd",1:2]),xlim=range(log(c10MnSD[,1])),ylim=range(log(c10MnSD[,2])))
c10base=mean(c10MnSD[c10MnSD[,4]=="pepnegrnd",1])
c10base
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-c10base))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-c10base))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10dsn<-c(1,2,2,2,1,1,2,2,1,2)
c10calls=unlist(lmfitall(c10dsn,c10vn-c10base))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10hcl=hclust(dist(t(c10vn)), method = "ward.D2")
plot(c10hcl)
hcldsn=c(2,3,3,3,2,1,2,2,1)
c10dsn<-c(1,2,2,2,1,1,2,2,1,2)
c10calls=unlist(lmfitall(hcldsn,c10vn-c10base))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10dsn<-c(1,2,2,2,1,1,2,2,1,2)
c10calls=unlist(lmfitall(hcldsn,c10vn-c10base))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10vclls
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(hcldsn,c10vn-c10base))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10calls=unlist(lmfitall(hcldsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/genenetalg.R')
genenetalg(c10vn)
genenetalg(c10vn, cog=.50)
c10gr=genenetalg(c10vn, cog=.50)
exgraphnel(gr)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/exgraphnel.R')
exgraphnel(gr)
exgraphnel(c10gr)
c10gr=genenetalg(t(c10vn))
c10cor
c10cor=cor(t(c10vn))
c10duppp
c10duppp[order(c10duppp[,2]),]
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10peptsn, stringsAsFactors = FALSE))
c10pepts=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10pepts, stringsAsFactors = FALSE))
c10vagr=lapply(c10peptsn, function(x){c10gr[c10gr$pep==x,1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr), stringsAsFactors = FALSE)
length(c10Mean)
c10dupp[]
c10duppp
c10duppp[order(c10duppp[,2]),]
library("reshape2", lib.loc="~/R/win-library/3.3")
dcast(c10duppp,pep+class)
dcast(c10duppp,pep~class)
dcast(c10duppp,pep~class)
dcast(c10duppp,pep+pep~class)
dcast(c10duppp,class~pep)
dcast(c10duppp,pep~class)
c10duppprecast=dcast(c10duppp, pep~class())
c10duppprecast=dcast(c10duppp, pep~class
)
pepdupp
c10dupp
c10dupp=unique(c10dupp)
c10dupp
c10duppp[pep==c10dupp[1],]
c10duppp[pep==c10dupp[2],]
c10duppp[c10duppp$pep==c10dupp[2],]
c10duppp[c10duppp$pep==c10dupp[2],1]
c(c1,c2)=c10duppp[c10duppp$pep==c10dupp[2],1]
[c1,c2]=c10duppp[c10duppp$pep==c10dupp[2],1]
cxx=c10duppp[c10duppp$pep==c10dupp[2],1]
cxx[1]
View(c4gr)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10duppprecast
c10duppprecast
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
c10dupreas
c10dupreas=reassdup(c10duppp)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
duppp[cxx,]
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/reassdup.R')
c10dupreas=reassdup(c10duppp)
c10dupreas
rownames(c10dupreas)
as.double(rownames(c10dupreas))
head(c10v)
head(c10gr)
c10grt=c10gr[-c10gr$pep %in% c10dupp]
c10grt=c10gr[-c10gr$pep %in% c10dupp,]
c10grt=c10gr[- c10gr$pep %in% c10dupp,]
c10grt=c10gr[!c10gr$pep %in% c10dupp,]
nrow(c10gr)
nrow(c10grt)
c10grt=rbind(c10grt,c10dupreas)
nrow(c10grt)
c10grt=unique(c1ogrt)
c10grt=unique(c10grt)
nrow(c10grt)
c10grt
nrow(c10grt)
nrow(c10gr)
c10gr=c10grt
rm(c10grt)
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10pepts=c10pnSet@featureRange@elementMetadata@listData$peptide
c10ncol=ncol(c10v)
colnames(c10v)=c10cnm
pp=lapply(c10pepts,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
colnames(c10vndf)=c10nms
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=3, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=lapply(c10peptsn, function(x){c10gr[c10gr$pep==x,1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD)
boxplot(Mean~Class, data=c10MnSD, notch=TRUE)
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
boxplot(2^Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
c10cor=cor(t(c10vn))
c10corcl=lapply(recl, function(x){c10cor[recl==x,recl==x]})
c10corcl
c10corcl[1]=c10cor[recl=="peppos",recl=="peppos"]
x=c10cor[recl=="peppos",recl=="peppos"]
c10corcl=list()
c10corcl[1]=x
x=c10cor[recl=="pep5",recl=="pep5"]
c10corcl[2]=x
x=c10cor[recl=="pep5pred",recl=="pep5pred"]
c10corcl[3]=x
x
c10corcl[3]=x
lengths(c10corcl)
c10corcl
c10corcl[[3]]
x=c10cor[recl=="peppos",recl=="peppos"]
c10corcl[1]=x
x=c10cor[recl=="peppos",recl=="peppos"]
c10gr
x=c10cor[c10gr[,1]=="peppos",c10gr[,1]=="peppos"]
c10corcl[1]=x
c10corcl[[1]]=x
c10corcl
x=c10cor[c10gr[,1]=="pep5pred",c10gr[,1]=="pep5pred"]
c10corcl[[2]]=x
x=c10cor[c10gr[,1]=="pepneg",c10gr[,1]=="pepneg"]
c10corcl[[3]]=x
x=c10cor[c10gr[,1]=="pepnegrnd",c10gr[,1]=="pepnegrnd"]
c10corcl[[4]]=x
x=c10cor[c10gr[,1]=="peprnd",c10gr[,1]=="peprnd"]
c10corcl[[5]]=x
lengths(c10corcl)
dims(c10corcl)
dim(c10corcl)
c10corcl[1]
dim(c10corcl[[1]])
mean(c10corcl)
lapply(c10corcl, mean)
mean(c10cor)
hist(c10cor, breaks=10000)
hist(c10cor, breaks=1000)
hist(c10corcl[[1]])
hist(c10corcl[[2]])
hist(c10corcl[[3]])
lapply(c10corcl,function(x){length(x[x>0.7])/length(x)})
names(c10corcl)=c("peppos","pep5pred","pepneg","pepnegrnd", "peprnd")
lapply(c10corcl,function(x){length(x[x>0.7])/length(x)})
library("corrplot", lib.loc="~/R/win-library/3.3")
corplot(c10corcl[[1]])
corrplot(c10corcl[[1]])
corrplot(c10corcl[[1]], method = "color", order = )
corrplot(c10corcl[[1]], method = "color", order = "AOE", hclust.method = "ward.D2" )
c10corpl1=corrplot(c10corcl[[1]], method = "color", order = "AOE", hclust.method = "ward.D2" )
c10corpl2=corrplot(c10corcl[[2]], method = "color", order = "AOE", hclust.method = "ward.D2" )
c10corpl2
plot(c10corpl2)
image(c10corpl2)
image(c10corpl2)
dim(c10corpl2)
corrplot(c10corpl2)
boxplot((c10MnSD$Mean-min(c10MnSD$Mean))~c10MnSD$Class, notch=TRUE, subset=c10MnSD[,3] %in% c("peppos", "pep5pred", "pepnegrnd","peprnd"), ylab="Log Mean Binding")
unique(c10MnSD[c10MnSD[,4]=="clneg", 3])
unique(c10MnSD[,4])
head(c10corcl)
dim(c10corcl)
length(c10corcl)
sel=c("clpos", "pepnegrnd", "pep5pred")
c10gr
sel=c("peppos", "pep5", "pep5other", "pepnegrnd", "pep5pred")
c10corcl[[6]]=c10cor[sel,sel]
sel=c10gr[,1] %in% sel
sel
c10corcl[[6]]=c10cor[sel,sel]
c10clmoregraph=genenetalg(c10corcl[[6]])
c10moregraph=exgraphnel(c10clmoregraph)
write.csv(c10moregraph[[1]],file="c10moreedges.csv")
write.csv(c10moregraph[[2]],file="c10morenodes.csv")
c10moregrclass=c10MnSD[rownames(c10MnSD) %in% c10moregraph[[2]],3]
edge.info(c10clmoregraph)
c10clmoreedges=edge.info(c10clmoregraph)
View(c10clmoreedges)
c10cor["AAWQMTWGGGS", "PILCQTFGGGS"]
c10cor["AEAYPPKGGGS", "GNMQLPKGGGS"]
c10gephianlz=read.csv("c10gephianlz.csv")
c10gephianlz=read.csv("c10gephianlz.csv")
c10gephitab=table(c10gephianlz[,2],c10gephianlz[,5])
summary(c10gephitab)
c10gephitab
boxplot(eigencentrality~class, data=c10gephianlz, notches=TRUE)
boxplot(log(eigencentrality)~class, data=c10gephianlz, notch=TRUE  )
boxplot(log(weighted.degree)~class, data=c10gephianlz, notch=TRUE  )
c10gephianlz
x=c10gephianlz[class==peppos,]
x=c10gephianlz[class=="peppos"",]
x=c10gephianlz[class=="peppos,]
x=c10gephianlz[class=="peppos",]
x=c10gephianlz["class"=="peppos",]
x
x=c10gephianlz[c10gephianlz$class=="peppos",]
x
x=c10gephianlz$class
x[x %in% c("pep5","pep5pred","pepother5")]="pepcl"
x
x=as.character(c10gephianlz$class)
x
x[x %in% c("pep5","pep5pred","pepother5")]="pepcl"
x
x[x %in% c("pepneg","pepneglo")]="pepn"
c10gephianlz=cbind(c10gephianlz,"sumlcl"=x)
boxplot(log(eigencentrality)~sumcl, data=c10gephianlz, notch=TRUE  )
head(c10gephianlz)
boxplot(log(eigencentrality)~sumlcl, data=c10gephianlz, notch=TRUE  )
boxplot(eigencentrality~sumlcl, data=c10gephianlz, notch=TRUE  )
hist(c10gephianlz[,"eigencentrality"])
hist(c10gephianlz[,"eigencentrality"], breaks = 50)
hist(log(c10gephianlz[,"eigencentrality"]), breaks = 50)
hist((c10gephianlz[,"eigencentrality"])^0.2, breaks = 50)
par(new=TRUE)
hist((c10gephianlz["sumlcl"=="pepcl","eigencentrality"])^0.2, breaks = 50, xlim=c(0.2, 1), col=2)
par(new=TRUE)
hist((c10gephianlz[c10gephianlz$sumlcl=="pepcl","eigencentrality"])^0.2, breaks = 50, xlim=c(0.2, 1), col=2)
par(new=TRUE)
hist((c10gephianlz[c10gephianlz$sumlcl=="peppos","eigencentrality"])^0.2, breaks = 50, xlim=c(0.2, 1), col=3)
par(new=TRUE)
hist((c10gephianlz[c10gephianlz$sumlcl=="peprnd","eigencentrality"])^0.2, breaks = 50, xlim=c(0.2, 1), col=4)
glm(sqrt(eigencentrality)~sumlcl*modularity_class, data=c10gephianlz)
summary(glm(sqrt(eigencentrality)~sumlcl*modularity_class, data=c10gephianlz))
summary(glm(sqrt(eigencentrality)~sumlcl, data=c10gephianlz))
summary(glm(sqrt(eigencentrality)~class, data=c10gephianlz))
c10gephianlz$id
flc10gephi=rownames(c10MnSD) %in% c10gephianlz$id
summary(table(c10MnSD$Class,flc10gephi))
table(c10MnSD$Class,flc10gephi)
colnames(c10MnSD)
table(c10MnSD$recl,flc10gephi)
library("matrixStats", lib.loc="~/R/win-library/3.3")
c10MnSD=cbind(c10MnSD,rowMax(c10vn) )
colnames(c10MnSD)
colnames(c10MnSD)[5]="Max"
boxplot(Max~class, data=c10MnSD, notch=TRUE)
boxplot(Max~Class, data=c10MnSD, notch=TRUE)
boxplot(Max~recl, data=c10MnSD, notch=TRUE)
plotMDS(c10vn)
library("limma", lib.loc="~/R/win-library/3.3")
plotMDS(c10vn)
plotMDS(c10vn[,c10MnSD$Class=="peppos" ])
plotMDS(c10vn[c10MnSD$Class=="peppos",])
plotMDS(c10vn[c10MnSD$Class=="peptu",])
plotMDS(c10vn[c10MnSD$Class=="pepturnd",])
plotMDS(c10vn[c10MnSD$Class %in% c("pepturnd","peptu"),])
plotMDS(c10vn[c10MnSD$Class %in% c("peprnd"),])
plotMDS(c10vn[c10MnSD$Class %in% c("pep5"),])
plotMDS(c10vn[c10MnSD$Class %in% c("pepother5"),])
plotMDS(c10vn[c10MnSD$recl %in% "clpos",])
heatmap(c10vn[c10MnSD$recl %in% "clpos",])
plotMDS(c10vn[c10MnSD$recl %in% c("clpos", "cltu"),])
plotMDS(c10vn[c10MnSD$recl %in% "clpos",])
plotMDS(c10vn[c10MnSD$Class %in% "peppos",])
plotMDS(c10vn[c10MnSD$Class %in% c("peppos","pepnegrnd"),])
plotMDS(c10vn[c10MnSD$Class %in% c("peppos","pep5pred"),])
heatmap(c10vn[c10MnSD$Class %in% "peppos",])
mean(c10MnSD[c10MnSD$Class=="pepnegrnd",1])
plot(c10MnSD$Mean-10.48,c10MnSD$SD )
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
View(design)
View(design)
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall.R')
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
View(cmx)
View(cmx)
n
n
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
View(design)
View(design)
n
n
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
c
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
View(cmx)
View(cmx)
View(cmx)
View(design)
View(design)
View(cmx)
View(cmx)
View(cmx)
View(cmx)
View(design)
View(design)
View(cmx)
View(cmx)
View(cmx)
View(cmx)
View(design)
View(design)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
c10calls=unlist(lmfitall1(c10dsn,c10vn-10.48))
View(cmx)
View(cmx)
View(cmx)
View(cmx)
View(cmx)
View(cmx)
c10calls=unlist(lmfitall1(c10dsn,c10vn-10))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10))
c10calls=unlist(lmfitall1(c10dsn,c10vn-9))
c10calls=unlist(lmfitall1(c10dsn,c10vn-9.5))
c10calls=unlist(lmfitall1(c10dsn,c10vn-9.75))
c10calls=unlist(lmfitall1(c10dsn,c10vn-9.8))
c10calls=unlist(lmfitall1(c10dsn,c10vn-10))
c10calls=unlist(lmfitall1(c10dsn,c10vn-9.9))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
nrowc10vclls
nrow(c10vclls)
c10vclls
plot(MDS(c10vclls))
plotMDS(c10vclls))
plotMDS(c10vclls)
c10calls
heatmap(c10vclls)
flc10
flc10=which(c10peptsn %in% c10calls)
plot(c10MnSD[flc10,1:2])
plot(c10MnSD[,1:2], col=flc10+1)
flc10
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2], col=flc10+1)
plot(log(c10MnSD[,1:2]), col=flc10+1)
table(c10MnSD$Class,flc10)
summary(table(c10MnSD$Class,flc10))
barplot(table(c10MnSD$Class, flc10))
barplot(table(flc10,c10MnSD$Class))
plot(table(flc10,c10MnSD$Class))
x=table(c10MnSD$Class,flc10)
x
x[,1]
plot(x[,1], x[,2])
text(x[,1], x[,2], labels = rownames(x))
c10calls=unlist(lmfitall1(c10dsn,c10vn[c10MnSD$Class=="peppos",]-9.9))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
plotMDS(c10vclls)
heatmap(c10vclls)
nrow(c10vclls)
c10calls=unlist(lmfitall1(c10dsn,c10vn[c10MnSD$Class=="peppos",]-10))
c10calls=unlist(lmfitall1(c10dsn,c10vn[c10MnSD$Class=="peppos",]-10.48))
c10calls=unlist(lmfitall1(c10dsn,c10vn[c10MnSD$Class=="peppos",]-10))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10pca$sdev
c10pca$rotation
library("mixtools", lib.loc="~/R/win-library/3.3")
c10nmix=normalmixEM(c10MnSD[,1])
c10mvmix=mvnormalmixEM(c10MnSD[,1:2], k=2)
flposterior=list(c10mvmix$posterior[,1]>.8,c10mvmix$posterior[,2]>.8)
colpost=flposterior[[1]]+flposterior[[2]]*2+1
plot(c10MnSD[,1:2], col=colpost)
plot(rnormmix(1000, c10mvmix$lambda,c10mvmix$mu,c10mvmix$sigma))
rnormmix(1000, c10mvmix$lambda,c10mvmix$mu,c10mvmix$sigma)
rnormmixrm(1000, c10mvmix$lambda,c10mvmix$mu,c10mvmix$sigma)
rmvnormmix(1000, c10mvmix$lambda,c10mvmix$mu,c10mvmix$sigma)
rmvnormmix(1000, c10mvmix$lambda,c10mvmix$mu,c10mvmix$sigma)
c10mvmix$sigma
c10mvmix$mu
c10mvmix$lambda
matrix(unlist(c10mvmix$mu), nrow=2)
matrix(unlist(c10mvmix$mu), nrow=2, byrow=TRUE)
rmvnormmix(1000, c10mvmix$lambda,matrix(unlist(c10mvmix$mu), nrow=2, byrow=TRUE),c10mvmix$sigma)
rmvnormmix(1000, c10mvmix$lambda,matrix(unlist(c10mvmix$mu), nrow=2, byrow=TRUE),matrix(unlist(c10mvmix$sigma), nrow=4, byrow=TRUE))
matrix(unlist(c10mvmix$sigma), nrow=4, byrow=TRUE)
matrix(unlist(c10mvmix$mu), nrow=2, byrow=TRUE)
rmvnormmix(1000, c10mvmix$lambda,matrix(unlist(c10mvmix$mu), nrow=2, byrow=TRUE),matrix(unlist(c10mvmix$sigma), nrow=4, byrow=TRUE))
plot(c10mvmix)
plot(c10mvmix, whichplots=1)
plot(c10mvmix, whichplots=2)
c10repnormm=repnormmixmodel.sel(c10vn, k=5)
c10repnormm=repnormmixmodel.sel(c10vn, k=4)
c10mvmix=mvnormalmixEM(c10MnSD[,1:2], k=5)
plot(c10mvmix)
plot(c10mvmix, whichplots=2)
c10mvmix$mu
c10mvmix$sigma
c10calls=unlist(lmfitall1(c10dsn,c10vn[c10MnSD$Class=="peppos",]-c10mvmix$mu[[2]][1]))
c10calls=unlist(lmfitall1(c10dsn,c10vn-c10mvmix$mu[[2]][1]))
c10calls=unlist(lmfitall1(c10dsn,c10vn-10)
)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn-10))
c10calls=unlist(lmfitall(c10dsn,c10vn-10.45))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-10.45))
c10calls=unlist(lmfitall(c10dsn,c10vn-10.45))
View(cmx)
View(design)
Q
Q
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitallL.R')
debugSource('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-10.45))
View(design)
View(cmx)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
View(design)
c10calls
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
debugSource('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
View(filepr)
View(filepr)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
View(lmfitallL)
View(lmfitallL)
c10calls=unlist(lmfitallL(c10dsn,c10vn))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-6))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-8))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-9))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-12))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-16))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-15))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-14))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=1e-13))
c10calls=unlist(lmfitallL(c10dsn,c10vn,p=5e-13))
c10calls=unlist(lmfitallL(c10dsn,c10vn-10.45))
c10calls=unlist(lmfitallL(c10dsn,c10vn-10))
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitallL.R')
c10calls=unlist(lmfitallL(c10dsn,c10vn-10))
View(cmx)
View(cmx)
View(design)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitallL.R')
c10calls=unlist(lmfitallL(c10dsn,c10vn-10))
c10calls=unlist(lmfitallL(c10dsn,c10vn))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitallL.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn))
View(design)
View(design)
View(cmx)
c10calls=unlist(lmfitall1(c10dsn,c10vn))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn))
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
c10calls=unlist(lmfitall1(c10dsn,c10vn))
View(design)
View(cmx)
Q
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/lmfitall1.R')
View(lmfitall)
library("pepStat", lib.loc="~/R/win-library/3.3")
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/filepr.R')
filepr("c10_class/", sh=F)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c10pSet=c10pSet[c10]
dirToParse="proc_c10_class"
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mapFile, use.flags = TRUE, log=TRUE)
makwPeptideSet
makePeptideSet
mappre="mapc10pre.csv"
mappost="mapc10post.csv"
dirToParse="proc_c10_class"
#cn=c("YPYDVPDYAG", "DYKDDDDKAS")
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
dirToParse="prox"
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
mappost
dirtoparse
dirtoParse
dirToParse
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
library("limma", lib.loc="~/R/win-library/3.3")
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
mappost
c10pSet=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
dirToParse="proc_c10_class"
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE)
dirToParse="X"
mappre="mapc10pre5.csv"
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
dirToParse="proc_c10_class"
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
mappre="mapc10pre.csv"
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE, bgCorrect.method = "normexp")
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE, bgCorrect.method = "normexp")
c10pSet=c10post
exprs(c10pSet)=exprs(c10post)-exprs(c10pre)
c10pSet@featureRange@elementMetadata@listData$featureID
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10pepts0=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10pepts0, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10dupreas=reassdup(c10duppp)
c10gr=c10gr[!c10gr$pep %in% c10dupp,]
c10gr=rbind(c10gr,c10dupreas)
c10gr=unique(c10grt)
c10gr=unique(c10gr)
c10gr
nrow(c10gr)
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10pepts=c10pnSet@featureRange@elementMetadata@listData$peptide
c10ncol=ncol(c10v)
colnames(c10v)=c10cnm
View(c10v)
range(c10v)
pp=lapply(c10pepts,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
colnames(c10vndf)=c10nms
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=3, method="affy")
View(c10vn)
range(c10vn)
c10vn=normalizeCyclicLoess(c10va, iterations=3, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=lapply(c10peptsn, function(x){c10gr[c10gr$pep==x,1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
plot(c10MnSD[,1:2])
plot(log(c10MnSD[,1:2]))
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn-10.48))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
plot(log(c10MnSD[,1:2]), col=c10MnSD[,3])
plot(log(c10MnSD[,1:2]), col=as.double(c10MnSD[,3]))
plot(log(c10MnSD[,1:2]), xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]))
plot(c10MnSD[,1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]))
View(c10MnSD)
View(c10MnSD)
plot(c10MnSD[c10MnSD[,4]=="clpos",1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]))
plot(c10MnSD[c10MnSD[,4]=="peprnd",1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]))
plot(c10MnSD[c10MnSD[,4]=="pepnegrnd",1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]))
plot(c10MnSD[c10MnSD[,4]=="pepnegrnd",1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]), col=(c10MnSD[,3]=="peppos")*1+(c10MnSD[,3]=="pepnegrnd")*2+(c10MnSD[,3]=="peprnd")*4)
plot(c10MnSD[c10MnSD[,4]=="pepnegrnd",1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]), col=(c10MnSD[,3]=="peppos")*1+(c10MnSD[,3]=="pepnegrnd")*2+(c10MnSD[,3]=="peprnd")*4+1)
plot(c10MnSD[,1:2], xlim=range(c10MnSD[,1]), ylim=range(c10MnSD[,2]), col=(c10MnSD[,3]=="peppos")*1+(c10MnSD[,3]=="pepnegrnd")*2+(c10MnSD[,3]=="peprnd")*4+1)
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
Q
View(lmfitall)
View(lmfitall)
View(lmfitall)
View(lmfitall)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-3.5))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10calls=unlist(lmfitall(c10dsn,c10vn-3))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10calls=unlist(lmfitall(c10dsn,c10vn-2))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-2))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-2))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn-2))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
nrow(c10vclls)
flc10=c10peptsn %in% c10calls
table(c10MnSD[,3],flc10)
summary(table(c10MnSD[,3],flc10))
summary(glm(flc10~c10MnSD, family=binomial ))
summary(glm(flc10~c10MnSD[,3], family=binomial ))
summary(glm(flc10~c10MnSD[,4], family=binomial ))
plotMSD(c10vclls)
plotMDS(c10vclls)
c10calls
c10callsgr=lapply(c10calls, function(x){c10MnSD[c10peptsn==x,3]})
plotMDS(c10Vclls[c10callsgr=="peppos"])
plotMDS(c10vclls[c10callsgr=="peppos"])
plotMDS(c10vclls[c10callsgr=="peppos",])
plotMDS(c10vclls[c10callsgr=="peprnd",])
plotMDS(c10vclls[c10callsgr=="pepnegrnd",])
plotMDS(c10vclls[c10callsgr=="peptu",])
plotMDS(c10vclls[c10callsgr=="pep5",])
plotMDS(c10vclls[c10callsgr=="pep5pred",])
plot(c10MnSD[,1:2], col=flc10)
plot(c10MnSD[,1:2], col=flc10+11)
plot(c10MnSD[,1:2], col=flc10+1)
library("limma", lib.loc="~/R/win-library/3.3")
library("pepStat", lib.loc="~/R/win-library/3.3")
plotMDS(c10vn)
plotMDS(c10vn[c10MnSD[,1]>5]&c10MnSD[,2]>0.5,)
plotMDS(c10vn[c10MnSD[,1]>5&c10MnSD[,2]>0.5,])
plotMDS(c10vn[c10MnSD[,3]=="peppos",])
plotMDS(c10vn[c10MnSD[,3]=="peptu",])
plotMDS(c10vn[c10MnSD[,3]=="peprnd",])
plotMDS(c10vn[c10MnSD[,3]=="pep5",])
plotMDS(c10vn[c10MnSD[,3]=="peplo",])
plotMDS(c10vn[c10MnSD[,3]=="pepneg",])
plotMDS(c10vn[c10MnSD[,3]=="pepneglo",])
plotMDS(c10vn[c10MnSD[,3]=="pepnegrnd",])
heatmap(c10vclls)
heatmap(c10vclls, method="ward.D2")
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
heatmap(c10vclls, hclustfun=hclust(method="ward.D2"))
heatmap(c10vclls, hclustfun=hclust)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls=unlist(lmfitall(c10dsn,c10vn[c10MnSD[,3]="peppos",], p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10calls=unlist(lmfitall(c10dsn,c10vn[c10MnSD[,3]=="peppos",], p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
c10calls=unlist(lmfitall(c10dsn,c10vn[c10MnSD[,4]=="clpos",], p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
install.packages(c("acepack", "colorspace", "curl", "DBI", "Epi", "evaluate", "fastcluster", "Hmisc", "irlba", "jsonlite", "kernlab", "lava", "matrixStats", "mgcv", "openssl", "packrat", "permute", "quantreg", "R6", "Rcpp", "reshape2", "rmarkdown", "rsconnect", "seqinr", "shiny", "SparseM", "stringi", "survival"))
x=c(1,2,3,4,5)
rep(x,5)
c10calls_x=unlist(lmfitall(c10dsn,c10vn-matrix(rep(c10MnSD[,1],10), nrow = nrow(c10MnSD))))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn-matrix(rep(c10MnSD[,1],10), nrow = nrow(c10MnSD))))
c10calls_x=unlist(lmfitall(c10dsn,c10vn-mean(c10vn)))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn-mean(c10vn)))
library("matrixStats", lib.loc="~/R/win-library/3.3")
c10calls_x=unlist(lmfitall(c10dsn,c10vn-(c10vn)))
c10calls_x=unlist(lmfitall(c10dsn,c10vn-colMeans(c10vn)))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn-colMeans(c10vn)))
c10calls_x=unlist(lmfitall(c10dsn,sweep(c10vn,2,mean)))
sweep(c10vn,2,mean)
sweep(c10vn,2,mean, "-")
c10vn
is.double(c10vn)
x=matrix(1:20, nrow = 5)
x
sweep(x,2,mean, FUN="-")
sweep(x,1,mean, FUN="-")
sweep(x,mean, FUN="-")
dims(x)
dims(x)
dims(x)
dims(as.array(x))
as.array(x)
is.matrix(x)
sweep(x, 1:4, mean, FUN="-")
sweep(x, MARGIN = 2, STATS=mean, FUN="-")
sweep(x, MARGIN = 2, STATS="mean", FUN="-")
sweep(x, MARGIN = c(1,2), STATS=mean, FUN="-")
x
sweep(x, MARGIN = x[,1:4], STATS=mean, FUN="-")
sweep(x, MARGIN = 2, STATS=mean, FUN="-")
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn)
)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn))
c10calls_x=unlist(lmfitall(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10calls_x=unlist(lmfitall(c10dsn,c10vn))
c10dsn<-c(1,2,2,2,1,1,2,2,1,2)
c10calls=unlist(lmfitall(c10dsn,c10vn))
hclust(t(c10vn))
hclust(c10vn)
hclust(dist(t(c10vn)), method="ward.D2")
c10hcl=hclust(dist(t(c10vn)), method="ward.D2")
plot(c10hcl)
c10dsn<-c(1,2,2,1,1,2,2,2,2,2)
c10calls=unlist(lmfitall(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfitall.R')
c10dsn<-c(1,2,2,1,1,2,2,2,2,2)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10calls
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/lmfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10dsn<-c(1,2,2,1,1,2,2,2,2,2)
c10calls=unlist(limfit(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10dsn<-c(4,2,3,4,4,2,1,2,3,1)
c10calls=unlist(limfit(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
colnames(c10vn)
sex=c("M","F","F","M","F","F","F","F","F","M")
debugSource('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
View(design)
View(design)
View(design)
View(design)
debugSource('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
debugSource('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
View(LOpwm)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
c10dsn<-c(1,2,3,2,1,1,2,3,2,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
c10calls=unlist(limfit(c10dsn,sex,c10vn))
View(design)
View(cmx)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.0001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.00001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.000001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.0000001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.0000000001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.00000000000001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.00000000000001))
View(design)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.01))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.0001))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.0001))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.01))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.01))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.01))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.1))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.25))
c10calls=unlist(limfit(c10dsn,sex,c10vn, p=0.55))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10pSet=c10post
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10pepts0=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10pepts0, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10dupreas=reassdup(c10duppp)
c10gr=c10gr[!c10gr$pep %in% c10dupp,]
c10gr=rbind(c10gr,c10dupreas)
c10gr=unique(c10gr)
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10pepts=c10pnSet@featureRange@elementMetadata@listData$peptide
c10ncol=ncol(c10v)
colnames(c10v)=c10cnm
pp=lapply(c10pepts,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
colnames(c10vndf)=c10nms
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=3, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=lapply(c10peptsn, function(x){c10gr[c10gr$pep==x,1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
library("multcomp", lib.loc="~/R/win-library/3.3")
rm(multcomp)
detach("package:multcomp", unload=TRUE)
remove.packages("multcomp", lib="~/R/win-library/3.3")
install.packages("multcomp")
library("multcomp", lib.loc="~/R/win-library/3.3")
library("survival", lib.loc="C:/Program Files/R/R-3.3.1/library")
detach("package:survival", unload=TRUE)
remove.packages("survival", lib="C:/Program Files/R/R-3.3.1/library")
install.packages("multcomp")
library("multcomp", lib.loc="~/R/win-library/3.3")
install.packages("kernlab")
install.packages("Rcpp")
install.packages("survival")
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
sex
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(lmfitall(c10dsn,c10vn))
c10calls=unlist(limfit(c10dsn,c10vn))
c10calls=unlist(limfit(c10dsn,sex,c10vn))
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.2))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.2))
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.2))
c10dsn<-c(1,2,3,4,5,6,7,8,9,10)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.2))
c10dsn<-c(1,2,3,4,1,1,5,6,1,7)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.2))
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.1))
c10dsn<-c(1,2,2,2,1,1,2,2,1,2)
c10dsn<-c(1,2,2,2,1,1,2,2,1,2)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.1))
plot(c10MnSD[,1:2])
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE, bgCorrect.method = "subtract")
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE, bgCorrect.method = "subtract")
c10pSet=c10post
exprs(c10pSet)=exprs(c10post)-exprs(c10pre)
#c10pSet=c10pSet[!is.na(c10pSet@featureRange@elementMetadata@listData$featureID),]
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10pepts0=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10pepts0, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10dupreas=reassdup(c10duppp)
c10gr=c10gr[!c10gr$pep %in% c10dupp,]
c10gr=rbind(c10gr,c10dupreas)
c10gr=unique(c10gr)
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10pepts=c10pnSet@featureRange@elementMetadata@listData$peptide
c10ncol=ncol(c10v)
colnames(c10v)=c10cnm
pp=lapply(c10pepts,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
colnames(c10vndf)=c10nms
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=1, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=lapply(c10peptsn, function(x){c10gr[c10gr$pep==x,1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE, bgCorrect.method = "subtract")
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE, bgCorrect.method = "subtract")
c10pSet=c10post
exprs(c10pSet)=exprs(c10post)-exprs(c10pre)
#c10pSet=c10pSet[!is.na(c10pSet@featureRange@elementMetadata@listData$featureID),]
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10pepts0=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10pepts0, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10dupreas=reassdup(c10duppp)
c10gr=c10gr[!c10gr$pep %in% c10dupp,]
c10gr=rbind(c10gr,c10dupreas)
c10gr=unique(c10gr)
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10pepts=c10pnSet@featureRange@elementMetadata@listData$peptide
c10ncol=ncol(c10v)
colnames(c10v)=c10cnm
pp=lapply(c10pepts,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
colnames(c10vndf)=c10nms
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
c10va=aggregate(c10vndf[,1:10],list(unlist(c10vndf$pp)),"mean")
c10peptsn=c10va$Group.1
rownames(c10va)=c10peptsn
c10va=c10va[,-1]
c10vn=normalizeCyclicLoess(c10va, iterations=1, method="affy")
c10Mean=rowMeans(c10vn)
c10SD=rowSds(c10vn)
c10vagr=lapply(c10peptsn, function(x){c10gr[c10gr$pep==x,1]})
c10MnSD=data.frame(unlist(c10Mean), unlist(c10SD), unlist(c10vagr), stringsAsFactors = FALSE)
colnames(c10MnSD)=c("Mean","SD","Class")
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
recl=c10MnSD$Class
recl[recl=="pep5"|recl=="pepother5"|recl=="peppos"]="clpos"
recl[recl=="pepneg"|recl=="pepneglo"|recl=="peppos"]="clneg"
recl[recl=="peptu"|recl=="pepturnd"]="cltu"
c10MnSD=cbind(c10MnSD,recl)
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
c10reclglm=glm(Mean~recl,family = gaussian, c10MnSD)
summary(c10reclglm)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
library("multcomp", lib.loc="~/R/win-library/3.3")
library("survival", lib.loc="~/R/win-library/3.3")
remove.packages("survival", lib="~/R/win-library/3.3")
install.packages("survival")
library("multcomp", lib.loc="~/R/win-library/3.3")
remove.packages("multcomp", lib="~/R/win-library/3.3")
install.packages("mulcomp")
install.packages("multcomp")
load("multcomp")
install.packages("multcomp")
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glht(c10reclglm, mcp(recl="Tukey")))
boxplot(log(Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
boxplot((Mean)~recl, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity")
boxplot(Mean~Class, data=c10MnSD, notch=TRUE, ylab=" Mean Log Intensity" )
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.05))
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.05))
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.5))
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.75))
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.9))
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.99))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
require(d3heatmap)
d3
makePeptideSet
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/gprLNSVM.R')
require(pepStat)
require(limma)
require(Biobase)
require(matrixStats)
require(d3heatmap)
require(multcomp)
filepr("c10_class/", sh=F)
filepr("c10_class/", sh=F)
filepr("c10_class/", sh=F)
c10pre=makePeptideSet(path=dirToParse, mapping.file = mappre, use.flags = TRUE, log=TRUE, bgCorrect.method = "normexp")
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE, bgCorrect.method = "normexp")
c10post=makePeptideSet(path=dirToParse, mapping.file = mappost, use.flags = TRUE, log=TRUE, bgCorrect.method = "normexp")
warnings()
c10pSet=c10post
exprs(c10pSet)=exprs(c10post)-exprs(c10pre)
#c10pSet=c10pSet[!is.na(c10pSet@featureRange@elementMetadata@listData$featureID),]
c10v0=c10pSet@assayData$exprs
c10cnm=paste(c10pSet@phenoData@data$ptid,c10pSet@phenoData@data$diag, sep  = "_")
colnames(c10v0)=c10cnm
narows=apply(c10v0, 1, function(x){all(!is.na(x))})
c10pSetn=c10pSet[narows,]
c10pepts0=c10pSetn@featureRange@elementMetadata@listData$peptide
c10gr=unique(data.frame(class=c10pSetn@featureRange@elementMetadata@listData$featureID,pep=c10pepts0, stringsAsFactors = FALSE))
c10dupp=c10gr[duplicated(c10gr$pep),2]
c10duppp=c10gr[c10gr$pep %in% c10dupp,]
c10dupreas=reassdup(c10duppp)
c10gr=c10gr[!c10gr$pep %in% c10dupp,]
c10gr=rbind(c10gr,c10dupreas)
c10gr=unique(c10gr)
c10pnSet=normalizeArray(c10pSetn, centered = FALSE)
c10v=c10pnSet@assayData$exprs
c10pepts=c10pnSet@featureRange@elementMetadata@listData$peptide
c10ncol=ncol(c10v)
colnames(c10v)=c10cnm
pp=lapply(c10pepts,function(x){x})
c10vndf=DataFrame(cbind(c10v, pp))
c10nms=c(c10cnm, "pp")
c10vndf=data.frame(matrix(unlist(c10vndf), nrow=nrow(c10vndf)),stringsAsFactors = FALSE)
colnames(c10vndf)=c10nms
for (i in 1:10) c10vndf[,i]=as.numeric(c10vndf[,i])
sex
cnms
cnm
c10cnm
x=paste(c10cnm, sex, sep = "_")
x
colnames(c10vn)=x
plotMDS(c10vn[c10MnSD[,3]=="peppos",])
plotMDS(c10vn[c10MnSD[,3]=="pepnegrnd",])
plotMDS(c10vn[c10MnSD[,3]=="peprnd",])
plotMDS(c10vn[c10MnSD[,3]=="peptu",])
plotMDS(c10vn[c10MnSD[,4]=="clpos",])
hclust(dist(t(c10vn)), method="ward.D2")
plot(hclust(dist(t(c10vn)), method="ward.D2"))
c10dsn<-c(4,3,3,4,4,3,2,3,1,2)
plot(as.array(table(c10MnSD[c10calls %in% c10peptsn,3], flc10)))
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
x
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr,])
plotMDS(c10vclls[c10vcllsgr=="peppos",])
plotMDS(c10vclls[c10vcllsgr=="pepneglo",])
plotMDS(c10vclls[c10vcllsgr=="peprnd",])
plotMDS(c10vclls[c10vcllsgr=="pepnegrnd",])
plotMDS(c10vclls[c10vcllsgr=="pep5pred",])
plotMDS(c10vclls[c10vcllsgr=="pep5",])
plotMDS(c10vclls[c10vcllsgr=="peppos",])
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,4]
plotMDS(c10vclls[c10vcllsgr=="clpos",])
plotMDS(c10vclls[c10vcllsgr=="clneg",])
plotMDS(c10vclls[c10vcllsgr %in% c("clpos","clneg"),])
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos","peptu"),])
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
plotMDS(c10vclls[c10vcllsgr %in% c("peprnd"),])
plotMDS(c10vclls[c10vcllsgr %in% c("pepnegrnd"),])
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
d3heatmap(c10vclls[c10vcllsgr %in% c("peppos"),], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3heatmap(c10vclls[c10vcllsgr %in% c("peptu"),], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
summary(x)
x
xx=glm(flc10~rownames(x), family = "binomial", data=x)
xx=glm(x, family = "binomial")
rownames(x)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x,flc10)
y
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
anova(y)
anova(summary(y))
nrow(c10vclls)
nrow(c10vn)
nrow(c10vn)/20
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=300, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
y=table(x,flc10)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x,flc10)
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=400, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
x=table(c10MnSD[c10calls %in% c10peptsn,3], flc10)
plot(x[,2]/x[,1])
text(x[,2]/x[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=400, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
barplot(y[,2]/y[,1])
text(y[,2]/y[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(z[order(z)])
#text(y[,2]/y[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
barplot(z[order(z)])
par(new=TRUE)
plot(c(1,9),c(400/5338,400/5338))
barplot(z[order(z)])
par(new=TRUE)
plot(c(1,9),c(400/5338,400/5338), ylim=c(0,0.12))
barplot(z[order(z)], ylim=c(0,12))
barplot(z[order(z)], ylim=c(0,0.12))
par(new=TRUE)
plot(c(1,9),c(400/5338,400/5338), ylim=c(0,0.12))
barplot(z[order(z)], ylim=c(0,0.12))
par(new=TRUE)
barplot(400/5338, ylim=c(0,0.12), col = 0)
barplot(400/5338, ylim=c(0,0.12), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,0.12))
nco=400
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=nco, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
#text(y[,2]/y[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
nco=450
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=nco, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
#text(y[,2]/y[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
d3heatmap(c10vclls[c10vcllsgr %in% c("peppos"),], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
nco=1780
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=nco, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
#text(y[,2]/y[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
d3heatmap(c10vclls[c10vcllsgr %in% c("peppos"),], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
# Search for all immunodiagnostically relevant calls
c10dsn<-c(1,2,3,2,1,1,2,3,1,3)
nco=1780
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=nco, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
#text(y[,2]/y[,1], labels = rownames(x))
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
d3heatmap(c10vclls[c10vcllsgr %in% c("peppos"),], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
# Search for all immunodiagnostically relevant calls
c10trpca=prcomp(c10vclls)
x=c10trpca$x[,1:7]
c10trzs=apply(x,2,function(i){pnorm(scale(i))})
rownames(c10trzs)=rownames(c10trpca$x)
c10trcalls=c10trzs[apply(c10trzs,1, function(x){any(x>0.95)}),]
c10trcalls=c10vn[c10peptsn %in% rownames(c10trcalls),]
plotMDS(c10trcalls)
nrow(c10trcalls)
c10trpca=prcomp(c10vclls)
x=c10trpca$x[,1:7]
c10trzs=apply(x,2,function(i){pnorm(scale(i))})
rownames(c10trzs)=rownames(c10trpca$x)
c10trcalls=c10trzs[apply(c10trzs,1, function(x){any(x>0.95)}),]
c10trcalls=c10vn[c10peptsn %in% rownames(c10trcalls),]
plotMDS(c10trcalls)
nrow(c10trcalls)
d3heatmap(c10trcalls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
install.packages("energy")
library("energy", lib.loc="~/R/win-library/3.3")
order(c10dsn)
c10dsn(order(c10dsn))
c10dsn[order(c10dsn)]
edist(t(c10trcalls)[order(c10dsn),], sizes = c10dsn[order(c10dsn)])
t(c10trcalls)[order(c10dsn),])
t(c10trcalls)[order(c10dsn),]
edist(t(c10trcalls)[order(c10dsn),], sizes = c(4,3,3))
library("d3heatmap", lib.loc="~/R/win-library/3.3")
require(energy)
eDc10=list()
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
for (n in L2:L1){
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))
eDC10=c(eDc10,c(n,En, Enp))
print(c(n, sum(En), sum(Enp)))
}
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Com_anlz2/limfit.R')
dist(c10vn)
dist(t(c10vn))
require(energy)
eDc10=list()
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
for (n in L2:L1){
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=mean(dist(t(y)))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=mean(dist(t(ypos)))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dY
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYp
eDc10=c(eDc10,c(n,En, Enp))
print(c(n, sum(En), sum(Enp)))
}
eDc10
summary(eDc10)
eDc10[[1]]
eDc10[[2]]
eDc10
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(0,nrow = L2-L1+1, ncol=3)
co=0
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=mean(dist(t(y)))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=mean(dist(t(ypos)))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dY
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYp
eDc10[co,]=c(n,min(En), min(Enp))
print(c(n, min(En), min(Enp)))
}
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(0,nrow = L2-L1+1, ncol=3)
co=0
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=mean(dist(t(y)))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=mean(dist(t(ypos)))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dY
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYp
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
dim(eDc10)
rm(eDC10)
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(0,nrow = L2-L1+1, ncol=3)
co=0
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=mean(dist(t(y)))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=mean(dist(t(ypos)))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dY
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYp
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
rm(eDC10)
dim(eDc10)
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(rep(0,(L2-L1+1)*3),nrow = L2-L1+1, ncol=3)
co=0
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=mean(dist(t(y)))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=mean(dist(t(ypos)))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dY
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYp
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
dim(eDc10)
eDc10=matrix(rep(0,(L2-L1+1)*3),nrow = L2-L1+1, ncol=3)
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(rep(0,(L1-L2+1)*3),nrow = L1-L2+1, ncol=3)
co=0
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=mean(dist(t(y)))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=mean(dist(t(ypos)))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dY
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYp
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
plot(eDc10[,1], eDc10[,2:3])
plot(eDc10[,1], eDc10[,2])
par(new=TRUE)
plot(eDc10[,1], eDc10[,2])
3
par(new=TRUE)
plot(eDc10[,1], eDc10[,2])
plot(eDc10[,1], eDc10[,3])
dsn
dsn
c10dsn
c10dsn[order(c10dsn)]
En
summary(En)
is.matrix(En)
typeof(En)
args(En)
attributes(En)
as.matrix(En)
as.matrix(En)[ij==1,ij==2]
ij=c10dsn[order(c10dsn)]
as.matrix(En)[ij==1,ij==2]
dY=dist(t(y))
dY[ij==1,ij==2]
as.matrix(dY[ij==1,ij==2])
as.matrix(dY)[ij==1,ij==2]
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(rep(0,(L1-L2+1)*3),nrow = L1-L2+1, ncol=3)
co=0
ij=c10dsn[order(c10dsn)]
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=dist(t(y))
dYd=matrix(rep(0,9), nrow=3)
for (i in 1:3) {
for (j in 1:3){
dYd[i,j]=mean(as.matrix(dY)[ij==1,ij==2])
}
}
dYd=as.dist((dYd))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=dist(t(ypos))
dYpd=matrix(rep(0,9), nrow=3)
for (i in 1:3) {
for (j in 1:3){
dYpd[i,j]=mean(as.matrix(dYp)[ij==1,ij==2])
}
}
dYpd=as.dist((dYpd))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dYd
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYpd
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(rep(0,(L1-L2+1)*3),nrow = L1-L2+1, ncol=3)
co=0
ij=c10dsn[order(c10dsn)]
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=dist(t(y))
dYd=matrix(rep(0,9), nrow=3)
for (i in 1:3) {
for (j in 1:3){
dYd[i,j]=2*mean(as.matrix(dY)[ij==1,ij==2])
}
}
dYd=as.dist((dYd))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peppos"),]
dYp=dist(t(ypos))
dYpd=matrix(rep(0,9), nrow=3)
for (i in 1:3) {
for (j in 1:3){
dYpd[i,j]=2*mean(as.matrix(dYp)[ij==1,ij==2])
}
}
dYpd=as.dist((dYpd))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dYd
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYpd
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
plot(eDc10[,1], eDc10[,2])
plot(eDc10[,1], eDc10[,3])
plot(eDc10[,1], eDc10[,3]/eDc10[,2])
View(eDc10)
eDc10peppos=eDc10[,3]
require(energy)
N=length(c10peptsn)
L1=N %/% 3
L2=N %/% 20
eDc10=matrix(rep(0,(L1-L2+1)*3),nrow = L1-L2+1, ncol=3)
co=0
ij=c10dsn[order(c10dsn)]
for (n in L2:L1){
co=co+1
x=unlist(limfit(c10dsn,sex,c10vn,n=n, p=0.05))
y=c10vn[which(c10peptsn %in% x),]
dY=dist(t(y))
dYd=matrix(rep(0,9), nrow=3)
for (i in 1:3) {
for (j in 1:3){
dYd[i,j]=2*mean(as.matrix(dY)[ij==1,ij==2])
}
}
dYd=as.dist((dYd))
ygr=c10MnSD[c10peptsn %in% x,3]
ypos=y[ygr %in% c("peprnd"),]
dYp=dist(t(ypos))
dYpd=matrix(rep(0,9), nrow=3)
for (i in 1:3) {
for (j in 1:3){
dYpd[i,j]=2*mean(as.matrix(dYp)[ij==1,ij==2])
}
}
dYpd=as.dist((dYpd))
En=edist(t(y)[order(c10dsn),], sizes = c(4,3,3))/dYd
Enp=edist(t(ypos)[order(c10dsn),], sizes = c(4,3,3))/dYpd
eDc10[co,]=matrix(c(n,min(En), min(Enp)), nrow=1, ncol=3)
print(c(n, min(En), min(Enp)))
}
plot(eDc10[,1], eDc10pepos/eDc10[,3])
plot(eDc10[,1], eDc10peppos/eDc10[,3])
plotMDS(c10vn[c10gr=="peprnd",])
c10gr
plotMDS(c10vn[c10gr[,1]=="peprnd",])
View(eDc10)
View(eDc10peppos)
eDcpeppos
eDc10peppos
library("tsne", lib.loc="~/R/win-library/3.3")
tsne(c10vclls, initial_dims = 10,perplexity = 10)
c10tsne=tsne(c10vclls, initial_dims = 10,perplexity = 10)
plot(c10tsne)
plot(c10tsne, col=c10vcllsgr="peppos")
plot(c10tsne, col=c10vcllsgr="peppos"+1)
plot(c10tsne, col=(c10vcllsgr=="peppos")+1)
c10tsne=tsne(t(c10vclls), initial_dims = 10,perplexity = 10)
plot(c10tsne, col=(c10vcllsgr=="peppos")+1)
plot(c10tsne)
c10tsne
text(c10tsne, colnames(c10vn))
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 3)
plot(c10tsne)
text(c10tsne, colnames(c10vn))
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 5)
plot(c10tsne)
text(c10tsne, colnames(c10vn))
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 7)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 4)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 2)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 3)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 5)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 6)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 4)
c10tsne=tsne(t(c10vclls), initial_dims = 3,perplexity = 5)
install.packages("C:/Users/Anastas/Desktop/coXpress.zip", repos = NULL, type = "win.binary")
library("coXpress", lib.loc="~/R/win-library/3.3")
remove.packages("coXpress", lib="~/R/win-library/3.3")
library("WGCNA", lib.loc="~/R/win-library/3.3")
allowWGCNAThreads(7)
plot(eDc10peppos)
eDc10=cbind(eDc10,eDc10peppos)
colnames(eDc10)=c("Nbestpep", "eD", "eDrnd","eDpos")
View(eDc10)
plot(eDc10[,1], eDc10[,4]/eDc10[,3])
plot(eDc10[,1], eDc10[,4]/eDc10[,2])
nco=1000
c10calls=unlist(limfit(c10dsn,sex,c10vn,n=nco, p=0.05))
c10vclls=c10vn[which(c10peptsn %in% c10calls),]
flc10=c10peptsn %in% c10calls
plot(c10MnSD[,1:2],col=flc10+1)
d3=d3heatmap(c10vclls, hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
d3
plotMDS(c10vclls)
x=c10MnSD[c10calls %in% c10peptsn,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
#text(y[,2]/y[,1], labels = rownames(x))ed
c10vcllsgr=c10MnSD[c10peptsn %in% c10calls,3]
plotMDS(c10vclls[c10vcllsgr %in% c("peppos"),])
glx=glm(flc10~x, family = binomial, data=y)
anova(glx)
d3heatmap(c10vclls[c10vcllsgr %in% c("peppos"),], hclustfun=hclwrd, scale="none", colors=csch, show_grid = FALSE)
# Search for all immunodiagnostically relevant calls
c10trpca=prcomp(c10vclls)
x=c10trpca$x[,1:7]
c10trzs=apply(x,2,function(i){pnorm(scale(i))})
rownames(c10trzs)=rownames(c10trpca$x)
c10trcalls=c10trzs[apply(c10trzs,1, function(x){any(x>0.95)}),]
c10trcalls=c10vn[c10peptsn %in% rownames(c10trcalls),]
plotMDS(c10trcalls)
library("d3heatmap", lib.loc="~/R/win-library/3.3")
View(c10trcalls)
plot(c10trpca)
plot(c10trpca$rotation[,1],c10trpca$rotation[,2])
text(c10trpca$rotation[,1],c10trpca$rotation[,2], labels = rownames(c10trpca$rotation))
c10trpca=prcomp(scale(c10vclls))
x=c10trpca$x[,1:10]
c10trzs=apply(x,2,function(i){pnorm(scale(i))})
rownames(c10trzs)=rownames(c10trpca$x)
c10trcalls=c10trzs[apply(c10trzs,1, function(x){any(x>0.95)}),]
c10trcalls=c10vn[c10peptsn %in% rownames(c10trcalls),]
plotMDS(c10trcalls)
plot(c10trpca)
plot(c10trpca$rotation[,1],c10trpca$rotation[,2])
text(c10trpca$rotation[,1],c10trpca$rotation[,2], labels = rownames(c10trpca$rotation))
plot(c10trpca$rotation[,2],c10trpca$rotation[,3])
text(c10trpca$rotation[,2],c10trpca$rotation[,3], labels = rownames(c10trpca$rotation))
plot(c10trpca$rotation[,4],c10trpca$rotation[,5])
text(c10trpca$rotation[,4],c10trpca$rotation[,5], labels = rownames(c10trpca$rotation))
plot(c10trpca$rotation[,6],c10trpca$rotation[,7])
text(c10trpca$rotation[,6],c10trpca$rotation[,7], labels = rownames(c10trpca$rotation))
plot(c10trpca$rotation[,8],c10trpca$rotation[,9])
text(c10trpca$rotation[,8],c10trpca$rotation[,9], labels = rownames(c10trpca$rotation))
x=c10trpca$x[,1:3]
c10trzs=apply(x,2,function(i){pnorm(scale(i))})
rownames(c10trzs)=rownames(c10trpca$x)
c10trcalls=c10trzs[apply(c10trzs,1, function(x){any(x>0.95)}),]
c10trcalls=c10vn[c10peptsn %in% rownames(c10trcalls),]
plotMDS(c10trcalls)
View(c10trzs)
View(c10trcalls)
flc10trc=c10peptsn %in% rownames(c10trcalls)
length(fl10trc[fl10trc])
length(flc10trc[flc10trc])
c10trcgr=c10MnSD[flc10trc,3]
table(c10trcgr)
table(c10gr)
table(c10MnSD[,3],flc10trc)
x=c10MnSD[,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
x=c10MnSD[c10peptsn %in% c10valls,3]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
x=c10MnSD[,4]
y=table(x, flc10)
z=y[,2]/y[,1]
barplot(nco/nrow(c10vn), ylim=c(0,max(z)), col = 0)
x
barplot(z[order(z)], ylim=c(0,max(z)))
plot(c10MnSD[,1:2],col=flc10trc+1)
x=c10MnSD[,3]
y=table(x, flc10trc)
z=y[,2]/y[,1]
barplot(136/nrow(c10vn), ylim=c(0,max(z)), col = 0)
par(new=TRUE)
barplot(z[order(z)], ylim=c(0,max(z)))
plotMDS(c10vclls[c10MnSD[,3]=="peppos",])
plotMDS(c10vclls[c10vcllsgr=="peppos",])
plot(c10vclls[c10vcllsgr=="peppos",])
x=c10vclls[c10vcllsgr=="peppos",]
apply(x,1,function(i){
plot(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)
lines(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)})
x=x[,order(c10dsn)]
x
View(x)
apply(x,1,function(i){
plot(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)
lines(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)})
x=c10vclls[c10vcllsgr=="peprnd",]
x=x[,order(c10dsn)]
apply(x,1,function(i){
plot(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)
lines(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)})
x=c10vclls[c10vcllsgr=="peprnd",]
x=x[,order(c10dsn)]
apply(x,1,function(i){
plot(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)
lines(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)})
x=c10vclls[c10vcllsgr=="pepnegrnd",]
x=x[,order(c10dsn)]
apply(x,1,function(i){
plot(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)
lines(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)})
apply(x,1,function(i){
plot(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)
lines(i, ylim=range(c10MnSD[,1]))
par(new=TRUE)})
data.frame(matrix(runif(50,1,50), nrow=5), row.names = paste(1:5,"r",sep = "_"))
x=data.frame(matrix(runif(50,1,50), nrow=5), row.names = paste(1:5,"r",sep = "_"))
melt(x)
x=cbind(c10vn, c10gr)
x=melt(x, id.vars = c("class","pep") )
library("stringi", lib.loc="~/R/win-library/3.3")
stri_extract_all(as.character(x$variable),regex="\\w(?=\\b)")
Diag=stri_extract_all(as.character(x$variable),regex="\\w(?=\\b)")
x=cbind(x,Diag)
x=x[,1:5]
x=x[,1:4]
length(Diag)
Diag-as.character(Diag)
Diag=as.character(Diag)
Diag
x=cbind(x, Diag)
summary(glm(value~class*Diag, data=(x))
)
summary(glm(value~class, data=(x)))
summary(glm(value~class, data=(x)), comtrol=list("peprnd"))
summary(glm(value~class, data=(x)), comtrol=list("classpeprnd"))
summary(glm(value~0+class, data=(x)), comtrol=list("classpeprnd"))
summary(glm(value~0+class, data=(x)), comtrol=list("classpeprnd"), contrasts(c(1,0,0,0,0,0,0,-1,0,0)))
is.factor(x$class)
x$class=as.factor(x$class)
summary(glm(value~0+class, data=(x)), comtrol=list("classpeprnd"), contrasts(c(1,0,0,0,0,0,0,-1,0,0)))
is.factor(x$class)
x$class
summary(glm(value~0+class, data=(x)), comtrol=list("classpeprnd"), contrasts(c(1,0,0,0,0,0,0,-1,0,0)))
summary(glm(value~0+class, data=x, comtrol=list("classpeprnd"), contrasts(c(1,0,0,0,0,0,0,-1,0,0)))
)
library("multcomp", lib.loc="~/R/win-library/3.3")
summary(glm(value~0+class, data=x, comtrol=list("classpeprnd"), contrasts=c(1,0,0,0,0,0,0,-1,0,0))
)
summary(glm(value~0+class, data=x, contrasts=c(1,0,0,0,0,0,0,-1,0,0))
)
xglm=glm(value~0+class, data=x)
summary(glht(xglm, mcp(rank="Tukey")))
summary(glht(xglm, mcp(class="Tukey")))
xglm=glm(value~class, data=x)
summary(glht(xglm, mcp(class="Tukey")))
xglm=glm(value~class*Diag, data=x)
summary(glht(xglm, mcp(class="Tukey")))
summary(glht(xglm, mcp(class*Diag="Tukey")))
boxplot(value~class, data=x, notch=TRUE  )
boxplot(value~class, data=x, notch=TRUE  )
xglm=glm(value~class*variable, data=x)
summary(glht(xglm, mcp(class="Tukey")))
xglm=glm(value~cvariable, data=x)
xglm=glm(value~variable, data=x)
summary(glht(xglm, mcp(class="Tukey")))
summary(glht(xglm, mcp(variable="Tukey")))
xglm=glm(value~class+variable+Diag, data=x)
summary(glht(xglm, mcp(class="Tukey")))
summary(glht(xglm, mcp(class+variable+Diag="Tukey")))
summary(glht(xglm, mcp("class+variable+Diag"="Tukey")))
summary(xglm)
c10MnDiag=cbind(rowMeans(c10vn[,c10dsn==1]),rowMeans(c10vn[,c10dsn==2]),rowMeans(c10vn[,c10dsn==3]))
colnames(c10MnDiag)=c("C","G","M")
c10MnDiag=apply(c10MnDiag,2,as.double)
c10MnDiag=as.data.frame(c10MnDiag)
c10MnDiag=cbind(C10MnDiag,c10MnSD[,3:4])
c10MnDiag=cbind(c10MnDiag,c10MnSD[,3:4])
c10MnDiag[,4]=as.factor(c10MnDiag[,4])
c10MnDiag[,4]=relevel(c10MnDiag[,4], "peprnd")
c10MnDiag[,5]=relevel(c10MnDiag[,5], "peprnd")
c10glm_C=glm(c~Class, data=c10MnDiag)
c10glm_C=glm(C~Class, data=c10MnDiag)
summary(c10glm_C)
c10glm_G=glm(G~Class, data=c10MnDiag)
summary(c10glm_G)
c10glm_M=glm(M~Class, data=c10MnDiag)
summary(c10glm_M)
savehistory("~/BG/NorwayLichtensteinIsland/Execution/exp/DB/071116.Rhistory")
ixchosen
load("C:/Users/Anastas/Google Drive/BG/NorwayLichtensteinIsland/Execution/exp/DB/071116.RData")
ixchosen
chosen79030
rndpODXs79030pwmEv
ODXs_790_30
pbinom(4,12,0.2)
View(findpvscore)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/findpvscore.R')
View(profchk)
source('~/BG/Project2015Dilyan/Microarray Data PEP20156310 Tu/Prdct/profchk.R')
op <- par(mfrow = c(3, 1), mgp = c(1.5, 0.8, 0), mar =  .1+c(3,3,2,1))
F10 <- ecdf(rnorm(10))
summary(F10)
plot(F10)
plot(F10, verticals = TRUE, do.points = FALSE)
F(10)
F10()
F10(1)
ODXs79030pwmsc
View(cnstrPWMtab0)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/cnstrPWMtab0.R')
View(LOpwm)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/LOpwm.R')
View(pscnt)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/pscnt.R')
dim(rndpepchr)
length(rndpepchr)
nrow(rndpepchr)
lengths(rndpepchr)
ixchosen
hist(rndpODXs79030pwmEv)
hist(rndpODXs79030pwmEv, breaks=100)
length(rndpODXs79030pwmEv<0.01)
length(rndpODXs79030pwmEv<0.001)
length(rndpODXs79030pwmEv[rndpODXs79030pwmEv<0.001])
length(rndpODXs79030pwmEv[rndpODXs79030pwmEv<0.01])
length(rndpODXs79030pwmEv[rndpODXs79030pwmEv<0.00001])
length(rndpODXs79030pwmEv[rndpODXs79030pwmEv<0.000001])
length(ixchosen)
length(rndpODXs79030pwmEv[rndpODXs79030pwmEv<0.00000001])
View(negsmpep)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
bot_rnd=negsmpep(ODXs79030pwmsc,rndpepchr, n=2000)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
bot_rnd=negsmpep(ODXs79030pwmsc,rndpepchr, n=2000)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
closeAllConnections()
bot_rnd=negsmpep(ODXs79030pwmsc,rndpepchr, n=2000)
View(res)
res[1:100]
x=res[1:1000]
save(x,file="x")
rndpepchr
load(file="x")
x
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
negsmpep(ODXs79030pwmsc,x, n=1000)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
closeAllConnections()
negsmpep(ODXs79030pwmsc,x, n=1000)
2^(-3.775)
2^(-1.11)
aaPh7_ok
x
worst1000=x
x=1:20
b
bg
bg=0.05
N=10
N=10:100
plot(x,pscnt(x,N[1],bg))
plot(x,pscnt(x,N[90],bg))
plot(1:N[90],pscnt(x,N[90],bg))
plot(1:N[90],pscnt(1:N[90],N[90],bg))
pscnt(1,10,bg)
pscnt(1,90,bg)
pscnt(1,90,0.02)
plot(1:N[90],pscnt(1:700,700,bg))
plot(1:700,pscnt(1:700,700,bg))
plot((1:700)/700,pscnt((1:700)/700,700,bg))
plot(1:700,pscnt((1:700)/700,700,bg))
plot((1:700)/700,pscnt(1:700,700,bg))
pscnt(1/700,pscnt(1,200,0.07))
pscnt(1/700,pscnt(1,200,bg=0.07))
pscnt(1/700,pscnt(1,700,bg=0.07))
plot(1/700,pscnt(1,700,bg=0.07))
plot(0,pscnt(0,700,bg=0.07))
pscnt(c(0,1,2,100,700),700,bg=0.05)
pscnt(c(0,1,2,100,700)/700,700,bg=0.05)
print(c(0,1,2,100,700)/700,pscnt(c(0,1,2,100,700),700,bg=0.05))
print(c(0,1,2,100,700)/700,pscnt(c(0,1,2,100,700),700,bg=0.05)))
print(c((0,1,2,100,700)/700,pscnt(c(0,1,2,100,700),700,bg=0.05)))
print(((0,1,2,100,700)/700,pscnt(c(0,1,2,100,700),700,bg=0.05)))
print(rbind((0,1,2,100,700)/700,pscnt(c(0,1,2,100,700),700,bg=0.05)))
print(rbind(c(0,1,2,100,700)/700,pscnt(c(0,1,2,100,700),700,bg=0.05)))
View(crclsel41)
View(crclsel)
View(hODX0)
View(KLDbycl)
View(pepmrndist)
library("bamboo", lib.loc="~/R/win-library/3.4")
detach("package:bamboo", unload=TRUE)
library("seqinr", lib.loc="~/R/win-library/3.4")
lseqinr()
source("https://bioconductor.org/biocLite.R")
biocLite("DECIPHER")
y
library("DECIPHER", lib.loc="~/R/win-library/3.4")
As.AAstr
View(peptotest)
peptotestAAset=AAStringSet(peptotest[,1])
HECpeptotest=PredictHEC(peptotestAAset, type = "prob")
View(HECpeptotest)
HECpeptotest=t(PredictHEC(peptotestAAset, type = "prob"))
View(HECpeptotest)
HECpeptotest
HECpeptotest=PredictHEC(peptotestAAset, type = "prob")
typeof(HECpeptotest)
HECpeptotest[[1]]
peptotestAAset
HECpeptotest=t(apply(peptotestAAset,1,function(i){PredictHEC(i, type = "prob")}))
HECpeptotest=t(apply(peptotest,1,function(x){PredictHEC(x[1], type = "prob")}))
HECpeptotest=t(apply(peptotest,1,function(x){
x=AAStringSet(x[1])
PredictHEC(x, type = "prob")}))
View(HECpeptotest)
HECpeptotest[1]
HECpeptotest[]2
HECpeptotest[[2]]
library("ggtern", lib.loc="~/R/win-library/3.4")
HECpeptotest[[1]][1]
HECpeptotest[[1]][[1]]
t(HECpeptotest[[1]][[1]])
HECpeptotestl=laplly(HECpeptotest,function(i){i[[1]]})
HECpeptotestl=lapply(HECpeptotest,function(i){i[[1]]})
View(HECpeptotestl)
length(HECpeptotestl)
HECpeptotest[[1]]
HECpeptotestl[[1]]
HECpeptotestl[[2]]
HECpeptotestl=lapply(HECpeptotest,function(i){t(i[[1]])})
HECpeptotestl[[1]]
plot <- ggtern(data = HECpeptotestl[[1]], aes(x = H, y = E, z = C)) +
geom_point(aes(fill = prob),
size = 6,
shape = 21,
color = black) +
ggtitle(peptotes[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
plot <- ggtern(data = HECpeptotestl[[1]], aes(x = H, y = E, z = C)) +
geom_point(aes(fill = prob),
size = 6,
shape = 21,
color = "black") +
ggtitle(peptotes[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
p1
p1=as.data.frame(HECpeptotestl[[1]])
p1
rownames(p1)=paste("pos",1:11,sep = "_")
p1
plot <- ggtern(data = p1, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = pos),
size = 6,
shape = 21,
color = black) +
ggtitle(peptotes[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
plot <- ggtern(data = p1, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = pos),
size = 6,
shape = 21,
color = black) +
ggtitle(peptotes[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
plot <- ggtern(data = p1, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = pos),
size = 6,
shape = 21,
color = "black") +
ggtitle(peptotes[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
plot <- ggtern(data = p1, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = pos),
size = 6,
shape = 21,
color = "black") +
ggtitle(peptotest[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
plot
plot <- ggtern(data = p1, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = "pos"),
size = 6,
shape = 21,
color = "black") +
ggtitle(peptotest[1,1]) +
labs(fill = peptotest[1,2]) +
theme_rgbw() +
theme(legend.position = c(0,1),
legend.justification = c(1, 1))
plot
HECpeptotest
HECpeptotestl
hist(p1[,1])
hist(p1[,2])
hist(p1[,3])
peptotes[1,]
peptotest[1,]
density(p1[,1])
warnings()
density(p1[,1], kernel="gaus")
plot(p1[,1])
plot(density(p1[,1], kernel="gaus"))
par(new=TRUE)
plot(p1[,1],1, xlim=c(-0.18, 0.5))
length(p[,1])
length(p1[,1])
plot(p1[,1],rep(1,11), xlim=c(-0.18, 0.5))
y
y0
y0=density(p1[,1], kernel="gaus")
y0
y0$x
y0$y
which.max(y0$y)
y0$x[which.max(y0$y)]
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[,1], peptotest[,2])
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[,1], peptotest[,2])
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[1:100,1], peptotest[1:100,2])
View(HECpep)
HECpep[[1]]
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[1:100,1], peptotest[1:100,2])
HECpep[[1]]
hecterplot(peptotest[1:100,1], peptotest[1:100,2])
t(HECpep[[1]])
t(HECpep[[1]])[,1]
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[1:100,1], peptotest[1:100,2])
typeof(peptotest[,2])
View(peptotest)
as.character(peptotest[,2])
hecterplot(peptotest[1:100,1], as.character(peptotest[1:100,2]))
as.integer(peptotest[,2])
hecterplot(peptotest[1:100,1], as.integer(peptotest[1:100,2]))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[1:100,1], as.integer(peptotest[1:100,2]))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[1:100,1], as.integer(peptotest[1:100,2]))
View(HECpep)
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
View(HECpep)
hecterplot(peptotest[1:100,1], as.integer(peptotest[1:100,2]))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[1:100,1], as.integer(peptotest[1:100,2]))
hecterplot(peptotest[1:1000,1], as.integer(peptotest[1:1000,2]))
hecterplot(peptotest[1:1000,1], as.character(peptotest[1:1000,2]))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
peptotest(1:600,)
peptotest[1:600,]
peptotest[500:600,]
peptotest[500:700,]
hecterplot(peptotest[500:700,1], as.character(peptotest[500:700,2]))
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[500:700,1], as.character(peptotest[500:700,2]))
View(HECpep)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[500:700,1], as.character(peptotest[500:700,2]))
debugSource('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[500:700,1], as.character(peptotest[500:700,2]))
View(HECpep)
table(code)
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[500:700,1], as.character(peptotest[500:700,2]))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[,1], as.character(peptotest[,2]))
hecterplot(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),1], as.character(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),2]))
hecterplot(peptotest[peptotest[,2] =="peppos",1], as.character(peptotest[peptotest[,2]=="peppos",2]))
hecterplot(peptotest[peptotest[,2] =="pepneg",1], as.character(peptotest[peptotest[,2]=="pepneg",2]))
hecterplot(peptotest[peptotest[,2] =="pepneglo",1], as.character(peptotest[peptotest[,2]=="pepneglo",2]))
hecterplot(peptotest[peptotest[,2] %in% c("pep5", "pepother5"),1], as.character(peptotest[peptotest[,2] %in% c("pep5", "pepother5"),2]))
table(peptotes[,2])
table(peptotest[,2])
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),1], as.character(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),2]))
View(pscnt)
peptotGGS=peptotest
peptotGGS[,1]=sapply(peptotGGS[,1], function(x){paste(x, "GGGS",sep="")})
View(peptotGGS)
View(peptotest)
rm(peptotGGS)
concatpeppos=paste(peppostive,sep="")
concatpeppos
concatpeppos=paste(peppostive,sep="", collapse="")
concatpeppos
length(concatpeppos)
lengths(concatpeppos)
nchar(concatpeppos)
library("stringi", lib.loc="~/R/win-library/3.4")
concatpeppos1=substr(concatpeppos, 1:987)
concatpeppos1=substr(concatpeppos, start = 1,stop = 987)
concatpeppos1
pepnegrnd
concatpepnegrnd1=paste(pepnegrnd[1:141], sep="", collapse="")
concatpepnegrnd1
x=sample(peppostive, 250)
x
write.csv(x,"peppossample.csv")
x=sample(pepnegrnd, 250)
write.csv(x,"pepnegrndsample.csv")
ODXs_790_30
x=ODXs_790_30[ODXs_790_30[,2]==0,1]
x
write.csv(x,"ODX790_30_cl0.csv")
SecStrCons=data.frame(list(peppos=c(10,15,75), pepnegrnd=c(15.4, 18, 66.6))
)
SecStrCons
rownames(SecStrCons)=c("H","E","C")
SecStrCons=t(SecStrCons)
SecStrCons
hecterplot(SecStrCons, c("Peppos", "Pepnegrnd"))
plot <- ggtern(data = SecStrCons, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = c("peppos","pepnegrnd")),
size = 2,
shape = 21,
color = "black") +
ggtitle("Predicted secondary structure of peptides") +
labs(fill = c("peppos","pepnegrnd")) +
theme_rgbw() +
theme(legend.position = c(0.1,1),
legend.justification = c(1,1))
plot
SecStrCons=as.data.frame(SecStrCons)
plot <- ggtern(data = SecStrCons, aes(x = H, y = E, z = C)) +
geom_point(aes(fill = c("peppos","pepnegrnd")),
size = 2,
shape = 21,
color = "black") +
ggtitle("Predicted secondary structure of peptides") +
labs(fill = c("peppos","pepnegrnd")) +
theme_rgbw() +
theme(legend.position = c(0.1,1),
legend.justification = c(1,1))
plot
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),1], as.character(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),2]))
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),1], as.character(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),2]))
peptotest
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/hecterplot.R')
hecterplot(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),1], as.character(peptotest[peptotest[,2] %in% c("peppos", "pepnegrnd"),2]))
x=ODXs_790_30[ODXs_790_30[,2]==1,1]
ODXs_790_30
x
write.csv(x,"ODX790_30_cl1N2.csv")
head(pepnegrnd)
bot_rnd
View(negsmpep)
bot_rnd=negsmpep(ODXs79030pwmsc,rndpepchr, n=2000)
x=negsmpep(ODXs79030pwmsc,rndpepchr[1:2000], n=2000)
x
source("https://bioconductor.org/biocLite.R")
biocLite()
source('~/BG/NorwayLichtensteinIsland/Execution/exp/DB/negsmpep.R')
pepnegrnd[1:10]
which(pepnegrnd=="PIISSCV")
which(pepnegrnd=="FRRRSQS")
which(pepnegrnd=="LFVCVMD")
which(pepnegrnd=="PNYYNCM")
which(pepnegrnd=="FSLCKYL")
which(pepnegrnd=="FSKCRNT")
which(pepnegrnd=="LFNSICS")
which(pepnegrnd=="PNNYCNL")
which(pepnegrnd=="PSICSST")
which(pepnegrnd=="LSTCGML")
pepnegrnd[1:10]
pepnegrnd[6:10]
pepnegrndsmpl=pepnegrnd[c(1:10,30,52:55,241,269,297,324,347)]
x=c(9,14,20,5,12,12,2,8,5,4,2,1,1,13,4,1,1,2,8,7)
pepnegrndsmpl=cbind(pepnegrndsmpl,x)
ODXsmx[[1]]
chosen79030
ODXs79030scchosen
ixchosen
rndpODXs79030pwmEv
clscores79030=data.frame((1:790)[order(rndpODXs79030pwmEv)],rndpODXs79030pwmEv[order(rndpODXs79030pwmEv)])
View(clscores79030)
colnames(clscores79030)=c("clNo", "p")
ixchosen
chosen79030
pep0c=read.csv(file="pep0c.csv")
pepposdropouts=peppostive[!(peppostive %in% pep0c[,2])]
pepposdropouts
pep0c
library("stringi", lib.loc="~/R/win-library/3.4")
pep0c[,2]=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS")
pep0c[,2]=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS)")
pep0c
pep0c=read.csv(file="pep0c.csv")
pep0c[,2]=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS)")
pep0c
pep0c=read.csv(file="pep0c.csv")
pep0c
pep0c[,2]=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS)")
pep0c=read.csv(file="pep0c.csv")
x=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS)")
x
pep0c[,2]=unlist(x)
pep0c
pepposdropouts=peppostive[!(peppostive %in% pep0c[,2])]
pepposdropouts
ODXs79030pepfl1=lapply(1:790, function(i){ODXs79030pep[[i]] %in% peppostive})
ODXs79030pepfl2=lapply(1:790, function(i){ODXs79030pep[[i]] %in% pepposdropouts})
xrng=range(log10(rndpODXs79030pwmEv+1.5e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,(mean(x)+1e-18)/10)),y,col=ODXs79030pepfl1+ODXs79030pepfl2+1,pch=16,cex=0.2+ODXs79030pepfl1+ODXs79030pepfl2)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1.5e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,(mean(x)+1e-18)/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]])
par(new=TRUE)})
par(new=FALSE)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,(x0+1e-18)/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]])
par(new=TRUE)})
par(new=FALSE)
ODXs79030pepfl1=lapply(1:790, function(i){ODXs79030pep[[i]] %in% peppostive})
ODXs79030pepfl2=lapply(1:790, function(i){ODXs79030pep[[i]] %in% pepposdropouts})
pep0c=read.csv(file="pep0c.csv")
x=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS)")
pep0c[,2]=unlist(x)
pepposdropouts=peppostive[!(peppostive %in% pep0c[,2])]
ODXs79030pepfl1=lapply(1:790, function(i){ODXs79030pep[[i]] %in% peppostive})
ODXs79030pepfl2=lapply(1:790, function(i){ODXs79030pep[[i]] %in% pepposdropouts})
library("stringi", lib.loc="~/R/win-library/3.4")
pep0c=read.csv(file="pep0c.csv")
x=stri_extract_all(pep0c[,2], regex = "\\w+(?=GGGS)")
pep0c[,2]=unlist(x)
pepposdropouts=peppostive[!(peppostive %in% pep0c[,2])]
ODXs79030pepfl1=lapply(1:790, function(i){ODXs79030pep[[i]] %in% peppostive})
ODXs79030pepfl2=lapply(1:790, function(i){ODXs79030pep[[i]] %in% pepposdropouts})
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,(x0+1e-18)/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]])
par(new=TRUE)})
par(new=FALSE)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]])
par(new=TRUE)})
par(new=FALSE)
rndpODXs79030pwmEv[[1]]
rndpODXs79030pwmEv
ODXs79030scall[[1]]
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(x,y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]])
par(new=TRUE)})
par(new=FALSE)
xrng=range(rndpODXs79030pwmEv+1e-18)
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(x,y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(rndpODXs79030pwmEv+1e-18)
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,x0/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+ODXs79030pepfl1[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,x0/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.1+ODXs79030pepfl1[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,x0/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.2+0.2*ODXs79030pepfl1[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,x0/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.3+0.3*ODXs79030pepfl1[[i]], xlim=xrng, ylim=yrng)
par(new=TRUE)})
par(new=FALSE)
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:790,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,x0/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.3+0.3*ODXs79030pepfl1[[i]], xlim=xrng, ylim=yrng)
})
xrng=range(log10(rndpODXs79030pwmEv+1e-18))
yrng=range(ODXs79030scall)
lapply(1:100,function(i){x0=rndpODXs79030pwmEv[[i]]+1e-18
x=rep(x0,length(ODXs79030scall[[i]]))
y=ODXs79030scall[[i]]
plot(log10(x+rnorm(length(x),0,x0/10)),y,col=ODXs79030pepfl1[[i]]+ODXs79030pepfl2[[i]]+1,pch=16,cex=0.3+0.3*ODXs79030pepfl1[[i]], xlim=xrng, ylim=yrng)
})
pepposCl=ODxs_790_30[ODXs_790_30[,1] %in% peppos,2]
pepposCl=ODXs_790_30[ODXs_790_30[,1] %in% peppos,2]
pepposCl=ODXs_790_30[ODXs_790_30[,1] %in% peppostive,2]
table(peposCl)
table(pepposCl)
table(ODXs_790_30[,2])
pepposCl=ODXs_790_30[ODXs_790_30[,1] %in% peppostive,2]+1
table(pepposCl)
fdrtool::
library("fdrtool", lib.loc="~/R/win-library/3.4")
fdrtool(rndpODXs79030pwmEv)
ixchosen
pep79030_99
peppostive
chosen79030
length(chosen79030[chosen79030])
pep79030_99
pep79030_99u=unlist(pep79030_99)
peppostive==pep79030_99u
ODXs_790_30[ODXs_790_30[,1] %in% peppostive,2]+1
table(ODXs_790_30[ODXs_790_30[,1] %in% peppostive,2]+1)
table(table(ODXs_790_30[ODXs_790_30[,1] %in% peppostive,2]+1))
chosen79030
length(chosen79030[chosen79030])
ODXs79030pepch
ixchosen
p=1e-6
pep79030_99=lapply(1:length(ixchosen), function(i){ODXs79030pepch[[i]][ODXs79030scchosen[[i]]>quantile(ODXs79030scchosen[[i]], probs=(1-p))]})
pep79030_99
pep_more
ODXs_790_30[ODXs_790_30[,1] %in% peppostive,2]+1
pepposCl
rndpODXs79030pwmEv[pepposCl]
range(rndpODXs79030pwmEv[pepposCl])
x=which(rndpODXs79030pwmEv<1e-4)
x
View(ODX0nm)
length(ODX0nm[ODX0nm[,2]>10,1])
load("~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/.RDataTmp1")
c10corcl
c10corcl=lapply(classes,function(c){c10cor[c10gr$class==c,c10gr$class==c]})
names(c10corcl)=classes
library("psychometric", lib.loc="~/R/win-library/3.4")
c10cozcl=lapply(c10corcl,function(c){x=c[lower.tri(c)]
r2z(x)})
names(c10cozcl)=classes
xr=range(unlist(c10cozcl))
xr
savehistory("~/BG/NorwayLichtensteinIsland/Execution/exp/DB0/051017.Rhistory")
